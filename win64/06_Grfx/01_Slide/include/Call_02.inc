;-----------------------------------------------------------------------------------------
;Макросы-аналоги INVOKE, которые помещают параметры в регистры и вызывают внешнюю функцию,
;но в отличие от invoke не изменяют регистра rsp
;(предполагается, что в прологе вызывающей процедуры выполнена инструкция sub rsp,20h,
;а в эпилоге - инструкция add rsp,20h)
;Вход: имя вызываемой функции и n параметров
;-----------------------------------------------------------------------------------------
Call5 MACRO funcname, par1, par2, par3, par4, par5
	mov rcx, par1
	mov rdx, par2
	mov r8, par3
	mov r9, par4
	mov rax, par5
	mov qword ptr [rsp+20h], rax
	call funcname
ENDM ;Call5
;-----------------------------------------------------------------------------------------
Call4 MACRO funcname, par1, par2, par3, par4
	mov rcx, par1
	mov rdx, par2
	mov r8, par3
	mov r9, par4
	call funcname
ENDM ;Call4
;-----------------------------------------------------------------------------------------
Call3 MACRO funcname, par1, par2, par3
	mov rcx, par1
	mov rdx, par2
	mov r8, par3
	call funcname
ENDM ;Call3
;-----------------------------------------------------------------------------------------
Call2 MACRO funcname, par1, par2
	mov rcx, par1
	mov rdx, par2
	call funcname
ENDM ;Call2
;-----------------------------------------------------------------------------------------
Call1 MACRO funcname, par1
	mov rcx, par1
	call funcname
ENDM ;Call1
;-----------------------------------------------------------------------------------------