<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oglmdi2.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oglmdi2.cpp</h1><a href="Oglmdi2_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">                                     OpenGL MDI Editor</font>
00003 <font class="comment"></font>
00004 <font class="comment">                                 Program by Alan Baylis 2001</font>
00005 <font class="comment">*/</font>
00006 
00007 <font class="preprocessor">#include &lt;windows.h&gt;</font>
00008 <font class="preprocessor">#include "<a class="code" href="shared_8h.html">shared.h</a>"</font>
00009 <font class="preprocessor">#include "<a class="code" href="vector_8h.html">vector.h</a>"</font>
00010 <font class="preprocessor">#include "<a class="code" href="vertex_8h.html">vertex.h</a>"</font>
00011 <font class="preprocessor">#include "<a class="code" href="quat_8h.html">quat.h</a>"</font>
00012 <font class="preprocessor">#include "<a class="code" href="matrix_8h.html">matrix.h</a>"</font>
00013 <font class="preprocessor">#include "<a class="code" href="texture_8h.html">texture.h</a>"</font>
00014 <font class="preprocessor">#include "<a class="code" href="general_8h.html">general.h</a>"</font>
00015 <font class="preprocessor">#include "<a class="code" href="object_8h.html">object.h</a>"</font>    <font class="comment">// Base class</font>
00016 <font class="preprocessor">#include "<a class="code" href="camera_8h.html">camera.h</a>"</font>
00017 <font class="preprocessor">#include "<a class="code" href="polygon_8h.html">polygon.h</a>"</font>
00018 <font class="preprocessor">#include "<a class="code" href="locmath_8h.html">locmath.h</a>"</font>
00019 <font class="preprocessor">#include "console.h"</font>
00020 <font class="preprocessor">#include "log.h"</font>
00021 <font class="preprocessor">#include "mmgr.h"</font>
00022 <font class="preprocessor">#include "resource.rh"</font> <font class="comment">// Header for resource file</font>
00023 
00024 <font class="comment">//Math</font>
<a name="l00025"></a><a class="code" href="Oglmdi2_8cpp.html#a0">00025</a> <font class="keywordtype">float</font> <a class="code" href="Oglmdi2_8cpp.html#a0">pi</a> = 3.141592;
<a name="l00026"></a><a class="code" href="Oglmdi2_8cpp.html#a1">00026</a> <font class="keywordtype">float</font> <a class="code" href="Oglmdi2_8cpp.html#a1">radians</a> = <a class="code" href="Oglmdi2_8cpp.html#a0">pi</a> / 180;
00027 
00028 <font class="comment">//Text variables</font>
<a name="l00029"></a><a class="code" href="Oglmdi2_8cpp.html#a2">00029</a> COLORREF <a class="code" href="Oglmdi2_8cpp.html#a2">colorRGB</a>; <font class="comment">// Color struct for Win32 text</font>
<a name="l00030"></a><a class="code" href="Oglmdi2_8cpp.html#a3">00030</a> RECT <a class="code" href="Oglmdi2_8cpp.html#a3">MainRect</a>;     <font class="comment">// Rect struct for Win32 text</font>
<a name="l00031"></a><a class="code" href="Oglmdi2_8cpp.html#a4">00031</a> LOGFONT <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>;   <font class="comment">// Font structs for Win32 text</font>
<a name="l00032"></a><a class="code" href="Oglmdi2_8cpp.html#a5">00032</a> HFONT <a class="code" href="Oglmdi2_8cpp.html#a5">hFont</a>;
<a name="l00033"></a><a class="code" href="Oglmdi2_8cpp.html#a6">00033</a> HFONT <a class="code" href="Oglmdi2_8cpp.html#a6">hOldFont</a>;
00034 
00035 <font class="comment">//Texture instance</font>
<a name="l00036"></a><a class="code" href="Oglmdi2_8cpp.html#a7">00036</a> <a class="code" href="classTEXTURE.html">TEXTURE</a>* <a class="code" href="Oglmdi2_8cpp.html#a7">texture</a> = <font class="keyword">new</font> <a class="code" href="classTEXTURE.html">TEXTURE</a>[1];
00037 
00038 <font class="comment">//Vertices for cube</font>
<a name="l00039"></a><a class="code" href="Oglmdi2_8cpp.html#a8">00039</a> <a class="code" href="classVERTEX.html">VERTEX</a>* <a class="code" href="Oglmdi2_8cpp.html#a8">vertex</a> = <font class="keyword">new</font> <a class="code" href="classVERTEX.html">VERTEX</a>[8];
00040 
00041 <font class="comment">//Polygons for cube</font>
<a name="l00042"></a><a class="code" href="Oglmdi2_8cpp.html#a9">00042</a> <a class="code" href="classPOLYGON.html">POLYGON</a>* <a class="code" href="Oglmdi2_8cpp.html#a9">polygon</a> = <font class="keyword">new</font> <a class="code" href="classPOLYGON.html">POLYGON</a>[12];
00043 
<a name="l00044"></a><a class="code" href="Oglmdi2_8cpp.html#a10">00044</a> <font class="keywordtype">char</font> <a class="code" href="Oglmdi2_8cpp.html#a10">g_szMainClassName</a>[] = <font class="stringliteral">"MainWindow"</font>;
<a name="l00045"></a><a class="code" href="Oglmdi2_8cpp.html#a11">00045</a> <font class="keywordtype">char</font> <a class="code" href="Oglmdi2_8cpp.html#a11">g_szChild3DClassName</a>[] = <font class="stringliteral">"3DOpenGL"</font>;   <font class="comment">// 3D window class name</font>
<a name="l00046"></a><a class="code" href="Oglmdi2_8cpp.html#a12">00046</a> <font class="keywordtype">char</font> <a class="code" href="Oglmdi2_8cpp.html#a12">g_szChild2DClassName</a>[] = <font class="stringliteral">"2DOpenGL"</font>;   <font class="comment">// 2D window class name</font>
<a name="l00047"></a><a class="code" href="Oglmdi2_8cpp.html#a13">00047</a> HINSTANCE <a class="code" href="Oglmdi2_8cpp.html#a13">g_hInst</a>;
<a name="l00048"></a><a class="code" href="Oglmdi2_8cpp.html#a14">00048</a> HWND <a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>;
<a name="l00049"></a><a class="code" href="Oglmdi2_8cpp.html#a15">00049</a> HWND <a class="code" href="Oglmdi2_8cpp.html#a15">g_hMainWindow</a>;
<a name="l00050"></a><a class="code" href="Oglmdi2_8cpp.html#a16">00050</a> RECT <a class="code" href="Oglmdi2_8cpp.html#a16">g_rectChild</a>;                           <font class="comment">// RECT structure for child window dimensions</font>
00051 
<a name="l00052"></a><a class="code" href="Oglmdi2_8cpp.html#a18">00052</a> <font class="keywordtype">float</font> <a class="code" href="Oglmdi2_8cpp.html#a17">g_fCubeRotationX</a>, <a class="code" href="Oglmdi2_8cpp.html#a18">g_fCubeRotationY</a>;
<a name="l00053"></a><a class="code" href="Oglmdi2_8cpp.html#a19">00053</a> <font class="keywordtype">float</font> <a class="code" href="Oglmdi2_8cpp.html#a19">Zoom</a> = 0.025;                            <font class="comment">// Ortho view zoom value</font>
<a name="l00054"></a><a class="code" href="Oglmdi2_8cpp.html#a20">00054</a> <font class="keywordtype">bool</font> <a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[256];                                 <font class="comment">// Array used for keyboard input</font>
<a name="l00055"></a><a class="code" href="Oglmdi2_8cpp.html#a21">00055</a> <font class="keywordtype">bool</font> <a class="code" href="Oglmdi2_8cpp.html#a21">released_key</a>[256];                        <font class="comment">// Array used for toggled keyboard input</font>
<a name="l00056"></a><a class="code" href="Oglmdi2_8cpp.html#a22">00056</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a22">VerticalShift</a> = 0;
<a name="l00057"></a><a class="code" href="Oglmdi2_8cpp.html#a23">00057</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a23">HorizontalShift</a> = 0;
<a name="l00058"></a><a class="code" href="Oglmdi2_8cpp.html#a24">00058</a> <font class="keywordtype">bool</font> <a class="code" href="Oglmdi2_8cpp.html#a24">g_bMouseDrag</a> = 0;                         <font class="comment">// Mouse capture flag</font>
<a name="l00059"></a><a class="code" href="Oglmdi2_8cpp.html#a25">00059</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a25">g_iMouseLastX</a>;                             <font class="comment">// Holds previous X position of mouse</font>
<a name="l00060"></a><a class="code" href="Oglmdi2_8cpp.html#a26">00060</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a26">g_iMouseLastY</a>;                             <font class="comment">// Holds previous Y position of mouse</font>
<a name="l00061"></a><a class="code" href="Oglmdi2_8cpp.html#a27">00061</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a27">g_iMouseDeltaX</a>;                            <font class="comment">// Holds the mouse increment in X since LastX</font>
<a name="l00062"></a><a class="code" href="Oglmdi2_8cpp.html#a28">00062</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a28">g_iMouseDeltaY</a>;                            <font class="comment">// Holds the mouse increment in Y since LastY</font>
<a name="l00063"></a><a class="code" href="Oglmdi2_8cpp.html#a29">00063</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>;
<a name="l00064"></a><a class="code" href="Oglmdi2_8cpp.html#a30">00064</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a30">ShortestDistance</a> = 10000;
<a name="l00065"></a><a class="code" href="Oglmdi2_8cpp.html#a31">00065</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a>;
<a name="l00066"></a><a class="code" href="Oglmdi2_8cpp.html#a32">00066</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a>;
<a name="l00067"></a><a class="code" href="Oglmdi2_8cpp.html#a33">00067</a> <font class="keywordtype">float</font> <a class="code" href="Oglmdi2_8cpp.html#a33">FrontDepth</a> = 90;
<a name="l00068"></a><a class="code" href="Oglmdi2_8cpp.html#a34">00068</a> <font class="keywordtype">float</font> <a class="code" href="Oglmdi2_8cpp.html#a34">TopDepth</a> = -90;
<a name="l00069"></a><a class="code" href="Oglmdi2_8cpp.html#a35">00069</a> <font class="keywordtype">float</font> <a class="code" href="Oglmdi2_8cpp.html#a35">LeftDepth</a> = -90;
<a name="l00070"></a><a class="code" href="Oglmdi2_8cpp.html#a36">00070</a> GLUquadricObj * <a class="code" href="Oglmdi2_8cpp.html#a36">sphere</a> = gluNewQuadric();       <font class="comment">// sphere for vertex selection</font>
00071 
<a name="l00072"></a><a class="code" href="Oglmdi2_8cpp.html#a37">00072</a> <font class="keywordtype">bool</font> <a class="code" href="Oglmdi2_8cpp.html#a37">g_bMouseDrag2</a> = 0;                         <font class="comment">// Mouse capture flag</font>
<a name="l00073"></a><a class="code" href="Oglmdi2_8cpp.html#a38">00073</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a38">g_iMouseLastX2</a>;                             <font class="comment">// Holds previous X position of mouse</font>
<a name="l00074"></a><a class="code" href="Oglmdi2_8cpp.html#a39">00074</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a39">g_iMouseLastY2</a>;                             <font class="comment">// Holds previous Y position of mouse</font>
<a name="l00075"></a><a class="code" href="Oglmdi2_8cpp.html#a40">00075</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a40">g_iMouseDeltaX2</a>;                            <font class="comment">// Holds the mouse increment in X since LastX</font>
<a name="l00076"></a><a class="code" href="Oglmdi2_8cpp.html#a41">00076</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a41">g_iMouseDeltaY2</a>;                            <font class="comment">// Holds the mouse increment in Y since LastY</font>
00077 
<a name="l00078"></a><a class="code" href="structCHILD.html">00078</a> <font class="keyword">typedef</font> <font class="keyword">struct </font><a class="code" href="structCHILD.html">CHILD</a>                           <font class="comment">// Child structure for each child window</font>
00079 {
<a name="l00080"></a><a class="code" href="structCHILD.html#m0">00080</a>     <font class="keywordtype">int</font> <a class="code" href="structCHILD.html#m0">iType</a>;                                 <font class="comment">// Type of child window (1 = 3D, 2 = XY (Front) ortho view, 3 = XZ (Top) ortho view, 4 = ZY (Left) ortho view)</font>
<a name="l00081"></a><a class="code" href="structCHILD.html#m1">00081</a>     HDC <a class="code" href="structCHILD.html#m1">hDC</a>;                                   <font class="comment">// Individual device context</font>
<a name="l00082"></a><a class="code" href="structCHILD.html#m2">00082</a>     HGLRC <a class="code" href="structCHILD.html#m2">hRC</a>;                                 <font class="comment">// Individual rendering context</font>
<a name="l00083"></a><a class="code" href="structCHILD.html#m3">00083</a>     HWND <a class="code" href="structCHILD.html#m3">hWnd</a>;                                 <font class="comment">// Handle to child window</font>
00084 } <a class="code" href="structCHILD.html">CHILD</a>;
00085 
<a name="l00086"></a><a class="code" href="Oglmdi2_8cpp.html#a43">00086</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a43">g_iMaxChild</a> = 50;                          <font class="comment">// Maximum number of child windows wanted</font>
<a name="l00087"></a><a class="code" href="Oglmdi2_8cpp.html#a44">00087</a> <font class="keywordtype">int</font> <a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> = 0;                           <font class="comment">// Number of child windows created</font>
<a name="l00088"></a><a class="code" href="Oglmdi2_8cpp.html#a45">00088</a> <a class="code" href="structCHILD.html">CHILD</a>* <a class="code" href="Oglmdi2_8cpp.html#a45">g_child</a> = <font class="keyword">new</font> <a class="code" href="structCHILD.html">CHILD</a>[<a class="code" href="Oglmdi2_8cpp.html#a43">g_iMaxChild</a>];       <font class="comment">// Create the CHILD structures</font>
00089 
<a name="l00090"></a><a class="code" href="Oglmdi2_8cpp.html#a46">00090</a> <font class="keywordtype">void</font> <a class="code" href="Oglmdi2_8cpp.html#a46">SetTextures</a>()
00091 {
00092     sprintf(texture[0].TexName, <font class="stringliteral">"%s"</font>, <font class="stringliteral">"tile1.tga"</font>);
00093     texture[0].<a class="code" href="classTEXTURE.html#a2">LoadTGA</a>();
00094 }
00095 
<a name="l00096"></a><a class="code" href="Oglmdi2_8cpp.html#a47">00096</a> <font class="keywordtype">void</font> <a class="code" href="Oglmdi2_8cpp.html#a47">SetVertices</a>()
00097 {
00098 <font class="comment">// Set cubes vertices</font>
00099 
00100     vertex[0].<a class="code" href="classVERTEX.html#m1">x</a> = -100;
00101     vertex[0].<a class="code" href="classVERTEX.html#m2">y</a> = -100;
00102     vertex[0].<a class="code" href="classVERTEX.html#m3">z</a> = 100;
00103 
00104     vertex[1].<a class="code" href="classVERTEX.html#m1">x</a> = 100;
00105     vertex[1].<a class="code" href="classVERTEX.html#m2">y</a> = -100;
00106     vertex[1].<a class="code" href="classVERTEX.html#m3">z</a> = 100;
00107 
00108     vertex[2].<a class="code" href="classVERTEX.html#m1">x</a> = 100;
00109     vertex[2].<a class="code" href="classVERTEX.html#m2">y</a> = 100;
00110     vertex[2].<a class="code" href="classVERTEX.html#m3">z</a> = 100;
00111 
00112     vertex[3].<a class="code" href="classVERTEX.html#m1">x</a> = -100;
00113     vertex[3].<a class="code" href="classVERTEX.html#m2">y</a> = 100;
00114     vertex[3].<a class="code" href="classVERTEX.html#m3">z</a> = 100;
00115 
00116     vertex[4].<a class="code" href="classVERTEX.html#m1">x</a> = -100;
00117     vertex[4].<a class="code" href="classVERTEX.html#m2">y</a> = -100;
00118     vertex[4].<a class="code" href="classVERTEX.html#m3">z</a> = -100;
00119 
00120     vertex[5].<a class="code" href="classVERTEX.html#m1">x</a> = 100;
00121     vertex[5].<a class="code" href="classVERTEX.html#m2">y</a> = -100;
00122     vertex[5].<a class="code" href="classVERTEX.html#m3">z</a> = -100;
00123 
00124     vertex[6].<a class="code" href="classVERTEX.html#m1">x</a> = 100;
00125     vertex[6].<a class="code" href="classVERTEX.html#m2">y</a> = 100;
00126     vertex[6].<a class="code" href="classVERTEX.html#m3">z</a> = -100;
00127 
00128     vertex[7].<a class="code" href="classVERTEX.html#m1">x</a> = -100;
00129     vertex[7].<a class="code" href="classVERTEX.html#m2">y</a> = 100;
00130     vertex[7].<a class="code" href="classVERTEX.html#m3">z</a> = -100;
00131 }
00132 
<a name="l00133"></a><a class="code" href="Oglmdi2_8cpp.html#a48">00133</a> <font class="keywordtype">void</font> <a class="code" href="Oglmdi2_8cpp.html#a48">SetPolygons</a>()
00134 {
00135 <font class="comment">// Set cubes polygons</font>
00136 
00137 <font class="comment">//Front</font>
00138     polygon[0].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[0];
00139     polygon[0].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[1];
00140     polygon[0].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[2];
00141 
00142     polygon[1].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[0];
00143     polygon[1].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[2];
00144     polygon[1].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[3];
00145 <font class="comment">//Back</font>
00146     polygon[2].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[5];
00147     polygon[2].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[4];
00148     polygon[2].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[7];
00149 
00150     polygon[3].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[5];
00151     polygon[3].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[7];
00152     polygon[3].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[6];
00153 <font class="comment">//Left</font>
00154     polygon[4].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[4];
00155     polygon[4].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[0];
00156     polygon[4].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[3];
00157 
00158     polygon[5].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[4];
00159     polygon[5].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[3];
00160     polygon[5].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[7];
00161 <font class="comment">//Right</font>
00162     polygon[6].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[1];
00163     polygon[6].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[5];
00164     polygon[6].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[6];
00165 
00166     polygon[7].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[1];
00167     polygon[7].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[6];
00168     polygon[7].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[2];
00169 <font class="comment">//Top</font>
00170     polygon[8].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[3];
00171     polygon[8].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[2];
00172     polygon[8].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[6];
00173 
00174     polygon[9].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[3];
00175     polygon[9].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[6];
00176     polygon[9].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[7];
00177 <font class="comment">//Bottom</font>
00178     polygon[10].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[5];
00179     polygon[10].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[1];
00180     polygon[10].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[0];
00181 
00182     polygon[11].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[0] = vertex[5];
00183     polygon[11].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[1] = vertex[0];
00184     polygon[11].<a class="code" href="classPOLYGON.html#m1">Vertex</a>[2] = vertex[4];
00185 
00186     polygon[0].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00187     polygon[1].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00188     polygon[2].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00189     polygon[3].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00190     polygon[4].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00191     polygon[5].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00192     polygon[6].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00193     polygon[7].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00194     polygon[8].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00195     polygon[9].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00196     polygon[10].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00197     polygon[11].<a class="code" href="classPOLYGON.html#a3">SetNormal</a>();
00198 }
00199 
00200 <font class="comment">/* Set the rendering options for OpenGL */</font>
<a name="l00201"></a><a class="code" href="Oglmdi2_8cpp.html#a49">00201</a> <font class="keywordtype">void</font> <a class="code" href="Oglmdi2_8cpp.html#a49">InitGL</a>()
00202 {
00203     glCullFace(GL_BACK);
00204     glEnable(GL_CULL_FACE);
00205     glClearColor(0.0, 0.0, 0.0, 0.0);
00206     glClearDepth(1.0);
00207     glDepthFunc(GL_LESS);
00208     glEnable(GL_DEPTH_TEST);
00209     glShadeModel(GL_SMOOTH);
00210     glEnable(GL_NORMALIZE);
00211 
00212     <font class="keywordtype">float</font> fMatAmbient[] = {0.8, 0.8, 0.8, 1.0};
00213     <font class="keywordtype">float</font> fMatDiffuse[] = {0.8, 0.8, 0.8, 1.0};
00214     <font class="keywordtype">float</font> fMatSpecular[] = {0.9, 0.9, 0.9, 1.0};
00215     <font class="keywordtype">float</font> fMatEmmision[] = {0.0, 0.0, 0.0, 1.0};
00216     <font class="keywordtype">float</font> fMatShininess[] = {100.0};
00217 
00218     glMaterialfv(GL_FRONT, GL_AMBIENT, fMatAmbient);
00219     glMaterialfv(GL_FRONT, GL_DIFFUSE, fMatDiffuse);
00220     glMaterialfv(GL_FRONT, GL_SPECULAR, fMatSpecular);
00221     glMaterialfv(GL_FRONT, GL_EMISSION, fMatEmmision);
00222     glMaterialfv(GL_FRONT, GL_SHININESS, fMatShininess);
00223 
00224     <font class="keywordtype">float</font> fLightAmbient[] = {0.2, 0.2, 0.2, 1.0};
00225     glLightfv(GL_LIGHT0, GL_AMBIENT, fLightAmbient);
00226     <font class="keywordtype">float</font> fLightPosition[] = {200.0, 0.0, 0.0, 1.0};
00227     glLightfv(GL_LIGHT0, GL_POSITION, fLightPosition);
00228 
00229     glEnable(GL_LIGHTING);
00230     glEnable(GL_LIGHT0);
00231 
00232     <a class="code" href="Oglmdi2_8cpp.html#a46">SetTextures</a>();
00233 
00234     glEnable(GL_TEXTURE_2D);
00235 }
00236 
00237 <font class="comment">// Sets the 3D Projection matrix. The Modelview matrix is set in the DrawGLScene routine</font>
<a name="l00238"></a><a class="code" href="Oglmdi2_8cpp.html#a50">00238</a> <font class="keywordtype">void</font> <a class="code" href="Oglmdi2_8cpp.html#a50">Set3DProjection</a>(<font class="keywordtype">int</font> iWidth, <font class="keywordtype">int</font> iHeight)
00239 {
00240     <font class="keywordflow">if</font>(iHeight == 0)
00241     {
00242         iHeight = 1;
00243     }
00244     glViewport(0, 0, iWidth, iHeight);
00245     glMatrixMode(GL_PROJECTION);
00246     glLoadIdentity();
00247     gluPerspective(45.0,(<font class="keywordtype">float</font>)iWidth/(<font class="keywordtype">float</font>)iHeight, 1, 1000.0);
00248 }
00249 
00250 <font class="comment">// Sets the 3D Projection matrix.</font>
<a name="l00251"></a><a class="code" href="Oglmdi2_8cpp.html#a51">00251</a> <font class="keywordtype">void</font> <a class="code" href="Oglmdi2_8cpp.html#a51">Set2DProjection</a>(<font class="keywordtype">int</font> iWidth, <font class="keywordtype">int</font> iHeight)
00252 {
00253     <font class="keywordflow">if</font>(iHeight == 0)
00254     {
00255         iHeight = 1;
00256     }
00257     glViewport(0, 0, iWidth, iHeight);
00258     glMatrixMode(GL_PROJECTION);
00259     glLoadIdentity();
00260     glOrtho(-iWidth * 0.5, iWidth * 0.5, -iHeight * 0.5, iHeight * 0.5, -2000, 2000);
00261 }
00262 
<a name="l00263"></a><a class="code" href="Oglmdi2_8cpp.html#a52">00263</a> <font class="keywordtype">void</font> <a class="code" href="Oglmdi2_8cpp.html#a52">Draw3DScene</a>(<font class="keywordtype">void</font>)
00264 {
00265     glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
00266     glMatrixMode(GL_MODELVIEW);
00267     glLoadIdentity();
00268 
00269     <font class="keywordflow">if</font>(g_bMouseDrag)                                       <font class="comment">// If left mouse button is down</font>
00270     {
00271         <a class="code" href="Oglmdi2_8cpp.html#a17">g_fCubeRotationX</a> += (float)<a class="code" href="Oglmdi2_8cpp.html#a28">g_iMouseDeltaY</a> * 0.5;   <font class="comment">// Apply mouse deltas to cube rotation values</font>
00272         <a class="code" href="Oglmdi2_8cpp.html#a18">g_fCubeRotationY</a> += (float)<a class="code" href="Oglmdi2_8cpp.html#a27">g_iMouseDeltaX</a> * 0.5;
00273     }
00274 
00275     glTranslatef(0.0,0.0,-500.0);
00276     glRotatef(<a class="code" href="Oglmdi2_8cpp.html#a17">g_fCubeRotationX</a>,1.0,0.0,0.0);
00277     glRotatef(<a class="code" href="Oglmdi2_8cpp.html#a18">g_fCubeRotationY</a>,0.0,1.0,0.0);
00278 
00279     glBindTexture(GL_TEXTURE_2D, texture[0].TexID);
00280     glPushMatrix();
00281     glBegin(GL_TRIANGLES);
00282         <font class="comment">// Front Face</font>
00283         glNormal3fv(&amp;polygon[0].Vertex[0].nx);
00284         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[0].Vertex[0].x);
00285         glTexCoord2f(1.0f, 0.0f); glVertex3fv(&amp;polygon[0].Vertex[1].x);
00286         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[0].Vertex[2].x);
00287 
00288         glNormal3fv(&amp;polygon[1].Vertex[0].nx);
00289         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[1].Vertex[0].x);
00290         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[1].Vertex[1].x);
00291         glTexCoord2f(0.0f, 1.0f); glVertex3fv(&amp;polygon[1].Vertex[2].x);
00292         <font class="comment">// Back Face</font>
00293         glNormal3fv(&amp;polygon[2].Vertex[0].nx);
00294         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[2].Vertex[0].x);
00295         glTexCoord2f(1.0f, 0.0f); glVertex3fv(&amp;polygon[2].Vertex[1].x);
00296         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[2].Vertex[2].x);
00297 
00298         glNormal3fv(&amp;polygon[3].Vertex[0].nx);
00299         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[3].Vertex[0].x);
00300         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[3].Vertex[1].x);
00301         glTexCoord2f(0.0f, 1.0f); glVertex3fv(&amp;polygon[3].Vertex[2].x);
00302         <font class="comment">// Top Face</font>
00303         glNormal3fv(&amp;polygon[4].Vertex[0].nx);
00304         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[4].Vertex[0].x);
00305         glTexCoord2f(1.0f, 0.0f); glVertex3fv(&amp;polygon[4].Vertex[1].x);
00306         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[4].Vertex[2].x);
00307 
00308         glNormal3fv(&amp;polygon[5].Vertex[0].nx);
00309         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[5].Vertex[0].x);
00310         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[5].Vertex[1].x);
00311         glTexCoord2f(0.0f, 1.0f); glVertex3fv(&amp;polygon[5].Vertex[2].x);
00312         <font class="comment">// Bottom Face</font>
00313         glNormal3fv(&amp;polygon[6].Vertex[0].nx);
00314         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[6].Vertex[0].x);
00315         glTexCoord2f(1.0f, 0.0f); glVertex3fv(&amp;polygon[6].Vertex[1].x);
00316         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[6].Vertex[2].x);
00317 
00318         glNormal3fv(&amp;polygon[7].Vertex[0].nx);
00319         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[7].Vertex[0].x);
00320         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[7].Vertex[1].x);
00321         glTexCoord2f(0.0f, 1.0f); glVertex3fv(&amp;polygon[7].Vertex[2].x);
00322         <font class="comment">// Right face</font>
00323         glNormal3fv(&amp;polygon[8].Vertex[0].nx);
00324         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[8].Vertex[0].x);
00325         glTexCoord2f(1.0f, 0.0f); glVertex3fv(&amp;polygon[8].Vertex[1].x);
00326         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[8].Vertex[2].x);
00327 
00328         glNormal3fv(&amp;polygon[9].Vertex[0].nx);
00329         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[9].Vertex[0].x);
00330         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[9].Vertex[1].x);
00331         glTexCoord2f(0.0f, 1.0f); glVertex3fv(&amp;polygon[9].Vertex[2].x);
00332         <font class="comment">// Left Face</font>
00333         glNormal3fv(&amp;polygon[10].Vertex[0].nx);
00334         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[10].Vertex[0].x);
00335         glTexCoord2f(1.0f, 0.0f); glVertex3fv(&amp;polygon[10].Vertex[1].x);
00336         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[10].Vertex[2].x);
00337 
00338         glNormal3fv(&amp;polygon[11].Vertex[0].nx);
00339         glTexCoord2f(0.0f, 0.0f); glVertex3fv(&amp;polygon[11].Vertex[0].x);
00340         glTexCoord2f(1.0f, 1.0f); glVertex3fv(&amp;polygon[11].Vertex[1].x);
00341         glTexCoord2f(0.0f, 1.0f); glVertex3fv(&amp;polygon[11].Vertex[2].x);
00342     glEnd();
00343     glPopMatrix();
00344 }
00345 
<a name="l00346"></a><a class="code" href="Oglmdi2_8cpp.html#a53">00346</a> <font class="keywordtype">void</font> <a class="code" href="Oglmdi2_8cpp.html#a53">Draw2DSceneFront</a>(HWND hWnd)
00347 {
00348     glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
00349     glMatrixMode(GL_MODELVIEW);
00350     glLoadIdentity();
00351     RECT WindowRect;
00352     GetClientRect(hWnd, &amp;WindowRect);
00353 <font class="comment">/*</font>
00354 <font class="comment">    glDisable(GL_TEXTURE_2D);</font>
00355 <font class="comment">    glDisable(GL_LIGHTING);</font>
00356 <font class="comment">    glColor4f(0.0, 1.0, 0.0, 1.0);</font>
00357 <font class="comment">    glPushMatrix();</font>
00358 <font class="comment">    glBegin(GL_LINES);</font>
00359 <font class="comment">        glVertex3f(-0.5 * WindowRect.right, TopDepth, 0);</font>
00360 <font class="comment">        glVertex3f(0.5 * WindowRect.right, TopDepth, 0);</font>
00361 <font class="comment">    glEnd();</font>
00362 <font class="comment">    glPopMatrix();</font>
00363 <font class="comment">    glEnable(GL_LIGHTING);</font>
00364 <font class="comment">    glEnable(GL_TEXTURE_2D);</font>
00365 <font class="comment"></font>
00366 <font class="comment">    glDisable(GL_TEXTURE_2D);</font>
00367 <font class="comment">    glDisable(GL_LIGHTING);</font>
00368 <font class="comment">    glColor4f(0.0, 0.0, 1.0, 1.0);</font>
00369 <font class="comment">    glPushMatrix();</font>
00370 <font class="comment">    glBegin(GL_LINES);</font>
00371 <font class="comment">        glVertex3f(LeftDepth, 0.5 * WindowRect.bottom, 0);</font>
00372 <font class="comment">        glVertex3f(LeftDepth, -0.5 * WindowRect.bottom, 0);</font>
00373 <font class="comment">    glEnd();</font>
00374 <font class="comment">    glPopMatrix();</font>
00375 <font class="comment">    glEnable(GL_LIGHTING);</font>
00376 <font class="comment">    glEnable(GL_TEXTURE_2D);</font>
00377 <font class="comment">*/</font>
00378     glDisable(GL_TEXTURE_2D);
00379     glDisable(GL_LIGHTING);
00380     glColor4f(1.0, 0.0, 0.0, 1.0);
00381     glPushMatrix();
00382     glBegin(GL_LINES);
00383         <font class="comment">// Front Face</font>
00384         glNormal3fv(&amp;polygon[0].Vertex[0].nx);
00385         glVertex3fv(&amp;polygon[0].Vertex[0].x);
00386         glVertex3fv(&amp;polygon[0].Vertex[1].x);
00387         glVertex3fv(&amp;polygon[0].Vertex[1].x);
00388         glVertex3fv(&amp;polygon[0].Vertex[2].x);
00389         glVertex3fv(&amp;polygon[0].Vertex[2].x);
00390         glVertex3fv(&amp;polygon[0].Vertex[0].x);
00391 
00392         glVertex3fv(&amp;polygon[1].Vertex[0].x);
00393         glVertex3fv(&amp;polygon[1].Vertex[1].x);
00394         glVertex3fv(&amp;polygon[1].Vertex[1].x);
00395         glVertex3fv(&amp;polygon[1].Vertex[2].x);
00396         glVertex3fv(&amp;polygon[1].Vertex[2].x);
00397         glVertex3fv(&amp;polygon[1].Vertex[0].x);
00398         <font class="comment">// Back Face</font>
00399         glNormal3fv(&amp;polygon[2].Vertex[0].nx);
00400         glVertex3fv(&amp;polygon[2].Vertex[0].x);
00401         glVertex3fv(&amp;polygon[2].Vertex[1].x);
00402         glVertex3fv(&amp;polygon[2].Vertex[1].x);
00403         glVertex3fv(&amp;polygon[2].Vertex[2].x);
00404         glVertex3fv(&amp;polygon[2].Vertex[2].x);
00405         glVertex3fv(&amp;polygon[2].Vertex[0].x);
00406 
00407         glVertex3fv(&amp;polygon[3].Vertex[0].x);
00408         glVertex3fv(&amp;polygon[3].Vertex[1].x);
00409         glVertex3fv(&amp;polygon[3].Vertex[1].x);
00410         glVertex3fv(&amp;polygon[3].Vertex[2].x);
00411         glVertex3fv(&amp;polygon[3].Vertex[2].x);
00412         glVertex3fv(&amp;polygon[3].Vertex[0].x);
00413         <font class="comment">// Top Face</font>
00414         glNormal3fv(&amp;polygon[4].Vertex[0].nx);
00415         glVertex3fv(&amp;polygon[4].Vertex[0].x);
00416         glVertex3fv(&amp;polygon[4].Vertex[1].x);
00417         glVertex3fv(&amp;polygon[4].Vertex[1].x);
00418         glVertex3fv(&amp;polygon[4].Vertex[2].x);
00419         glVertex3fv(&amp;polygon[4].Vertex[2].x);
00420         glVertex3fv(&amp;polygon[4].Vertex[0].x);
00421 
00422         glVertex3fv(&amp;polygon[5].Vertex[0].x);
00423         glVertex3fv(&amp;polygon[5].Vertex[1].x);
00424         glVertex3fv(&amp;polygon[5].Vertex[1].x);
00425         glVertex3fv(&amp;polygon[5].Vertex[2].x);
00426         glVertex3fv(&amp;polygon[5].Vertex[2].x);
00427         glVertex3fv(&amp;polygon[5].Vertex[0].x);
00428         <font class="comment">// Bottom Face</font>
00429         glNormal3fv(&amp;polygon[6].Vertex[0].nx);
00430         glVertex3fv(&amp;polygon[6].Vertex[0].x);
00431         glVertex3fv(&amp;polygon[6].Vertex[1].x);
00432         glVertex3fv(&amp;polygon[6].Vertex[1].x);
00433         glVertex3fv(&amp;polygon[6].Vertex[2].x);
00434         glVertex3fv(&amp;polygon[6].Vertex[2].x);
00435         glVertex3fv(&amp;polygon[6].Vertex[0].x);
00436 
00437         glVertex3fv(&amp;polygon[7].Vertex[0].x);
00438         glVertex3fv(&amp;polygon[7].Vertex[1].x);
00439         glVertex3fv(&amp;polygon[7].Vertex[1].x);
00440         glVertex3fv(&amp;polygon[7].Vertex[2].x);
00441         glVertex3fv(&amp;polygon[7].Vertex[2].x);
00442         glVertex3fv(&amp;polygon[7].Vertex[0].x);
00443         <font class="comment">// Right face</font>
00444         glNormal3fv(&amp;polygon[8].Vertex[0].nx);
00445         glVertex3fv(&amp;polygon[8].Vertex[0].x);
00446         glVertex3fv(&amp;polygon[8].Vertex[1].x);
00447         glVertex3fv(&amp;polygon[8].Vertex[1].x);
00448         glVertex3fv(&amp;polygon[8].Vertex[2].x);
00449         glVertex3fv(&amp;polygon[8].Vertex[2].x);
00450         glVertex3fv(&amp;polygon[8].Vertex[0].x);
00451 
00452         glVertex3fv(&amp;polygon[9].Vertex[0].x);
00453         glVertex3fv(&amp;polygon[9].Vertex[1].x);
00454         glVertex3fv(&amp;polygon[9].Vertex[1].x);
00455         glVertex3fv(&amp;polygon[9].Vertex[2].x);
00456         glVertex3fv(&amp;polygon[9].Vertex[2].x);
00457         glVertex3fv(&amp;polygon[9].Vertex[0].x);
00458         <font class="comment">// Left Face</font>
00459         glNormal3fv(&amp;polygon[10].Vertex[0].nx);
00460         glVertex3fv(&amp;polygon[10].Vertex[0].x);
00461         glVertex3fv(&amp;polygon[10].Vertex[1].x);
00462         glVertex3fv(&amp;polygon[10].Vertex[1].x);
00463         glVertex3fv(&amp;polygon[10].Vertex[2].x);
00464         glVertex3fv(&amp;polygon[10].Vertex[2].x);
00465         glVertex3fv(&amp;polygon[10].Vertex[0].x);
00466 
00467         glVertex3fv(&amp;polygon[11].Vertex[0].x);
00468         glVertex3fv(&amp;polygon[11].Vertex[1].x);
00469         glVertex3fv(&amp;polygon[11].Vertex[1].x);
00470         glVertex3fv(&amp;polygon[11].Vertex[2].x);
00471         glVertex3fv(&amp;polygon[11].Vertex[2].x);
00472         glVertex3fv(&amp;polygon[11].Vertex[0].x);
00473     glEnd();
00474     glPopMatrix();
00475     glEnable(GL_LIGHTING);
00476     glEnable(GL_TEXTURE_2D);
00477 
00478 <font class="keywordtype">float</font> mat_ambient[] = { 0.8, 0.5, 0.1, 1.0 };
00479 <font class="keywordtype">float</font> mat_diffuse[] = { 0.8, 0.5, 0.1, 1.0 };
00480 glMaterialfv(GL_FRONT, GL_AMBIENT, mat_ambient);
00481 glMaterialfv(GL_FRONT, GL_DIFFUSE, mat_diffuse);
00482 glDisable(GL_TEXTURE_2D);
00483 glPushMatrix();
00484 glTranslatef(vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].x, vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].y, vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].z);
00485 gluQuadricOrientation(<a class="code" href="Oglmdi2_8cpp.html#a36">sphere</a>, GLU_OUTSIDE);
00486 gluSphere(<a class="code" href="Oglmdi2_8cpp.html#a36">sphere</a>,10.0,20,20);
00487 glPopMatrix();
00488 glEnable(GL_TEXTURE_2D);
00489 
00490 }
00491 
<a name="l00492"></a><a class="code" href="Oglmdi2_8cpp.html#a54">00492</a> <font class="keywordtype">void</font> <a class="code" href="Oglmdi2_8cpp.html#a54">Draw2DSceneTop</a>(HWND hWnd)
00493 {
00494     glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
00495     glMatrixMode(GL_MODELVIEW);
00496     glLoadIdentity();
00497     glRotatef(90, 1, 0, 0);
00498     RECT WindowRect;
00499     GetClientRect(hWnd, &amp;WindowRect);
00500 <font class="comment">/*</font>
00501 <font class="comment">    glDisable(GL_TEXTURE_2D);</font>
00502 <font class="comment">    glDisable(GL_LIGHTING);</font>
00503 <font class="comment">    glColor4f(1.0, 0.0, 0.0, 1.0);</font>
00504 <font class="comment">    glPushMatrix();</font>
00505 <font class="comment">    glBegin(GL_LINES);</font>
00506 <font class="comment">        glVertex3f(-0.5 * WindowRect.right, 0, FrontDepth);</font>
00507 <font class="comment">        glVertex3f(0.5 * WindowRect.right, 0, FrontDepth);</font>
00508 <font class="comment">    glEnd();</font>
00509 <font class="comment">    glPopMatrix();</font>
00510 <font class="comment">    glEnable(GL_LIGHTING);</font>
00511 <font class="comment">    glEnable(GL_TEXTURE_2D);</font>
00512 <font class="comment"></font>
00513 <font class="comment">    glDisable(GL_TEXTURE_2D);</font>
00514 <font class="comment">    glDisable(GL_LIGHTING);</font>
00515 <font class="comment">    glColor4f(0.0, 0.0, 1.0, 1.0);</font>
00516 <font class="comment">    glPushMatrix();</font>
00517 <font class="comment">    glBegin(GL_LINES);</font>
00518 <font class="comment">        glVertex3f(LeftDepth, 0,  0.5 * WindowRect.bottom);</font>
00519 <font class="comment">        glVertex3f(LeftDepth, 0, -0.5 * WindowRect.bottom);</font>
00520 <font class="comment">    glEnd();</font>
00521 <font class="comment">    glPopMatrix();</font>
00522 <font class="comment">    glEnable(GL_LIGHTING);</font>
00523 <font class="comment">    glEnable(GL_TEXTURE_2D);</font>
00524 <font class="comment">*/</font>
00525     glDisable(GL_TEXTURE_2D);
00526     glDisable(GL_LIGHTING);
00527     glColor4f(0.0, 1.0, 0.0, 1.0);
00528     glPushMatrix();
00529     glBegin(GL_LINES);
00530         <font class="comment">// Front Face</font>
00531         glNormal3fv(&amp;polygon[0].Vertex[0].nx);
00532         glVertex3fv(&amp;polygon[0].Vertex[0].x);
00533         glVertex3fv(&amp;polygon[0].Vertex[1].x);
00534         glVertex3fv(&amp;polygon[0].Vertex[1].x);
00535         glVertex3fv(&amp;polygon[0].Vertex[2].x);
00536         glVertex3fv(&amp;polygon[0].Vertex[2].x);
00537         glVertex3fv(&amp;polygon[0].Vertex[0].x);
00538 
00539         glVertex3fv(&amp;polygon[1].Vertex[0].x);
00540         glVertex3fv(&amp;polygon[1].Vertex[1].x);
00541         glVertex3fv(&amp;polygon[1].Vertex[1].x);
00542         glVertex3fv(&amp;polygon[1].Vertex[2].x);
00543         glVertex3fv(&amp;polygon[1].Vertex[2].x);
00544         glVertex3fv(&amp;polygon[1].Vertex[0].x);
00545         <font class="comment">// Back Face</font>
00546         glNormal3fv(&amp;polygon[2].Vertex[0].nx);
00547         glVertex3fv(&amp;polygon[2].Vertex[0].x);
00548         glVertex3fv(&amp;polygon[2].Vertex[1].x);
00549         glVertex3fv(&amp;polygon[2].Vertex[1].x);
00550         glVertex3fv(&amp;polygon[2].Vertex[2].x);
00551         glVertex3fv(&amp;polygon[2].Vertex[2].x);
00552         glVertex3fv(&amp;polygon[2].Vertex[0].x);
00553 
00554         glVertex3fv(&amp;polygon[3].Vertex[0].x);
00555         glVertex3fv(&amp;polygon[3].Vertex[1].x);
00556         glVertex3fv(&amp;polygon[3].Vertex[1].x);
00557         glVertex3fv(&amp;polygon[3].Vertex[2].x);
00558         glVertex3fv(&amp;polygon[3].Vertex[2].x);
00559         glVertex3fv(&amp;polygon[3].Vertex[0].x);
00560         <font class="comment">// Top Face</font>
00561         glNormal3fv(&amp;polygon[4].Vertex[0].nx);
00562         glVertex3fv(&amp;polygon[4].Vertex[0].x);
00563         glVertex3fv(&amp;polygon[4].Vertex[1].x);
00564         glVertex3fv(&amp;polygon[4].Vertex[1].x);
00565         glVertex3fv(&amp;polygon[4].Vertex[2].x);
00566         glVertex3fv(&amp;polygon[4].Vertex[2].x);
00567         glVertex3fv(&amp;polygon[4].Vertex[0].x);
00568 
00569         glVertex3fv(&amp;polygon[5].Vertex[0].x);
00570         glVertex3fv(&amp;polygon[5].Vertex[1].x);
00571         glVertex3fv(&amp;polygon[5].Vertex[1].x);
00572         glVertex3fv(&amp;polygon[5].Vertex[2].x);
00573         glVertex3fv(&amp;polygon[5].Vertex[2].x);
00574         glVertex3fv(&amp;polygon[5].Vertex[0].x);
00575         <font class="comment">// Bottom Face</font>
00576         glNormal3fv(&amp;polygon[6].Vertex[0].nx);
00577         glVertex3fv(&amp;polygon[6].Vertex[0].x);
00578         glVertex3fv(&amp;polygon[6].Vertex[1].x);
00579         glVertex3fv(&amp;polygon[6].Vertex[1].x);
00580         glVertex3fv(&amp;polygon[6].Vertex[2].x);
00581         glVertex3fv(&amp;polygon[6].Vertex[2].x);
00582         glVertex3fv(&amp;polygon[6].Vertex[0].x);
00583 
00584         glVertex3fv(&amp;polygon[7].Vertex[0].x);
00585         glVertex3fv(&amp;polygon[7].Vertex[1].x);
00586         glVertex3fv(&amp;polygon[7].Vertex[1].x);
00587         glVertex3fv(&amp;polygon[7].Vertex[2].x);
00588         glVertex3fv(&amp;polygon[7].Vertex[2].x);
00589         glVertex3fv(&amp;polygon[7].Vertex[0].x);
00590         <font class="comment">// Right face</font>
00591         glNormal3fv(&amp;polygon[8].Vertex[0].nx);
00592         glVertex3fv(&amp;polygon[8].Vertex[0].x);
00593         glVertex3fv(&amp;polygon[8].Vertex[1].x);
00594         glVertex3fv(&amp;polygon[8].Vertex[1].x);
00595         glVertex3fv(&amp;polygon[8].Vertex[2].x);
00596         glVertex3fv(&amp;polygon[8].Vertex[2].x);
00597         glVertex3fv(&amp;polygon[8].Vertex[0].x);
00598 
00599         glVertex3fv(&amp;polygon[9].Vertex[0].x);
00600         glVertex3fv(&amp;polygon[9].Vertex[1].x);
00601         glVertex3fv(&amp;polygon[9].Vertex[1].x);
00602         glVertex3fv(&amp;polygon[9].Vertex[2].x);
00603         glVertex3fv(&amp;polygon[9].Vertex[2].x);
00604         glVertex3fv(&amp;polygon[9].Vertex[0].x);
00605         <font class="comment">// Left Face</font>
00606         glNormal3fv(&amp;polygon[10].Vertex[0].nx);
00607         glVertex3fv(&amp;polygon[10].Vertex[0].x);
00608         glVertex3fv(&amp;polygon[10].Vertex[1].x);
00609         glVertex3fv(&amp;polygon[10].Vertex[1].x);
00610         glVertex3fv(&amp;polygon[10].Vertex[2].x);
00611         glVertex3fv(&amp;polygon[10].Vertex[2].x);
00612         glVertex3fv(&amp;polygon[10].Vertex[0].x);
00613 
00614         glVertex3fv(&amp;polygon[11].Vertex[0].x);
00615         glVertex3fv(&amp;polygon[11].Vertex[1].x);
00616         glVertex3fv(&amp;polygon[11].Vertex[1].x);
00617         glVertex3fv(&amp;polygon[11].Vertex[2].x);
00618         glVertex3fv(&amp;polygon[11].Vertex[2].x);
00619         glVertex3fv(&amp;polygon[11].Vertex[0].x);
00620     glEnd();
00621     glPopMatrix();
00622     glEnable(GL_LIGHTING);
00623     glEnable(GL_TEXTURE_2D);
00624 
00625 <font class="keywordtype">float</font> mat_ambient[] = { 0.8, 0.5, 0.1, 1.0 };
00626 <font class="keywordtype">float</font> mat_diffuse[] = { 0.8, 0.5, 0.1, 1.0 };
00627 glMaterialfv(GL_FRONT, GL_AMBIENT, mat_ambient);
00628 glMaterialfv(GL_FRONT, GL_DIFFUSE, mat_diffuse);
00629 glDisable(GL_TEXTURE_2D);
00630 glPushMatrix();
00631 glTranslatef(vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].x, vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].y, vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].z);
00632 gluQuadricOrientation(<a class="code" href="Oglmdi2_8cpp.html#a36">sphere</a>, GLU_OUTSIDE);
00633 gluSphere(<a class="code" href="Oglmdi2_8cpp.html#a36">sphere</a>,10.0,20,20);
00634 glPopMatrix();
00635 glEnable(GL_TEXTURE_2D);
00636 
00637 }
00638 
<a name="l00639"></a><a class="code" href="Oglmdi2_8cpp.html#a55">00639</a> <font class="keywordtype">void</font> <a class="code" href="Oglmdi2_8cpp.html#a55">Draw2DSceneLeft</a>(HWND hWnd)
00640 {
00641     glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
00642     glMatrixMode(GL_MODELVIEW);
00643     glLoadIdentity();
00644     glRotatef(90, 0, 1, 0);
00645     RECT WindowRect;
00646     GetClientRect(hWnd, &amp;WindowRect);
00647 <font class="comment">/*</font>
00648 <font class="comment">    glDisable(GL_TEXTURE_2D);</font>
00649 <font class="comment">    glDisable(GL_LIGHTING);</font>
00650 <font class="comment">    glColor4f(1.0, 0.0, 0.0, 1.0);</font>
00651 <font class="comment">    glPushMatrix();</font>
00652 <font class="comment">    glBegin(GL_LINES);</font>
00653 <font class="comment">        glVertex3f(0, -0.5 * WindowRect.bottom, FrontDepth);</font>
00654 <font class="comment">        glVertex3f(0, 0.5 * WindowRect.bottom, FrontDepth);</font>
00655 <font class="comment">    glEnd();</font>
00656 <font class="comment">    glPopMatrix();</font>
00657 <font class="comment">    glEnable(GL_LIGHTING);</font>
00658 <font class="comment">    glEnable(GL_TEXTURE_2D);</font>
00659 <font class="comment"></font>
00660 <font class="comment">    glDisable(GL_TEXTURE_2D);</font>
00661 <font class="comment">    glDisable(GL_LIGHTING);</font>
00662 <font class="comment">    glColor4f(0.0, 1.0, 0.0, 1.0);</font>
00663 <font class="comment">    glPushMatrix();</font>
00664 <font class="comment">    glBegin(GL_LINES);</font>
00665 <font class="comment">        glVertex3f(0, TopDepth, -0.5 * WindowRect.right);</font>
00666 <font class="comment">        glVertex3f(0, TopDepth, 0.5 * WindowRect.right);</font>
00667 <font class="comment">    glEnd();</font>
00668 <font class="comment">    glPopMatrix();</font>
00669 <font class="comment">    glEnable(GL_LIGHTING);</font>
00670 <font class="comment">    glEnable(GL_TEXTURE_2D);</font>
00671 <font class="comment">*/</font>
00672     glDisable(GL_TEXTURE_2D);
00673     glDisable(GL_LIGHTING);
00674     glColor4f(0.0, 0.0, 1.0, 1.0);
00675     glPushMatrix();
00676     glBegin(GL_LINES);
00677         <font class="comment">// Front Face</font>
00678         glNormal3fv(&amp;polygon[0].Vertex[0].nx);
00679         glVertex3fv(&amp;polygon[0].Vertex[0].x);
00680         glVertex3fv(&amp;polygon[0].Vertex[1].x);
00681         glVertex3fv(&amp;polygon[0].Vertex[1].x);
00682         glVertex3fv(&amp;polygon[0].Vertex[2].x);
00683         glVertex3fv(&amp;polygon[0].Vertex[2].x);
00684         glVertex3fv(&amp;polygon[0].Vertex[0].x);
00685 
00686         glVertex3fv(&amp;polygon[1].Vertex[0].x);
00687         glVertex3fv(&amp;polygon[1].Vertex[1].x);
00688         glVertex3fv(&amp;polygon[1].Vertex[1].x);
00689         glVertex3fv(&amp;polygon[1].Vertex[2].x);
00690         glVertex3fv(&amp;polygon[1].Vertex[2].x);
00691         glVertex3fv(&amp;polygon[1].Vertex[0].x);
00692         <font class="comment">// Back Face</font>
00693         glNormal3fv(&amp;polygon[2].Vertex[0].nx);
00694         glVertex3fv(&amp;polygon[2].Vertex[0].x);
00695         glVertex3fv(&amp;polygon[2].Vertex[1].x);
00696         glVertex3fv(&amp;polygon[2].Vertex[1].x);
00697         glVertex3fv(&amp;polygon[2].Vertex[2].x);
00698         glVertex3fv(&amp;polygon[2].Vertex[2].x);
00699         glVertex3fv(&amp;polygon[2].Vertex[0].x);
00700 
00701         glVertex3fv(&amp;polygon[3].Vertex[0].x);
00702         glVertex3fv(&amp;polygon[3].Vertex[1].x);
00703         glVertex3fv(&amp;polygon[3].Vertex[1].x);
00704         glVertex3fv(&amp;polygon[3].Vertex[2].x);
00705         glVertex3fv(&amp;polygon[3].Vertex[2].x);
00706         glVertex3fv(&amp;polygon[3].Vertex[0].x);
00707         <font class="comment">// Top Face</font>
00708         glNormal3fv(&amp;polygon[4].Vertex[0].nx);
00709         glVertex3fv(&amp;polygon[4].Vertex[0].x);
00710         glVertex3fv(&amp;polygon[4].Vertex[1].x);
00711         glVertex3fv(&amp;polygon[4].Vertex[1].x);
00712         glVertex3fv(&amp;polygon[4].Vertex[2].x);
00713         glVertex3fv(&amp;polygon[4].Vertex[2].x);
00714         glVertex3fv(&amp;polygon[4].Vertex[0].x);
00715 
00716         glVertex3fv(&amp;polygon[5].Vertex[0].x);
00717         glVertex3fv(&amp;polygon[5].Vertex[1].x);
00718         glVertex3fv(&amp;polygon[5].Vertex[1].x);
00719         glVertex3fv(&amp;polygon[5].Vertex[2].x);
00720         glVertex3fv(&amp;polygon[5].Vertex[2].x);
00721         glVertex3fv(&amp;polygon[5].Vertex[0].x);
00722         <font class="comment">// Bottom Face</font>
00723         glNormal3fv(&amp;polygon[6].Vertex[0].nx);
00724         glVertex3fv(&amp;polygon[6].Vertex[0].x);
00725         glVertex3fv(&amp;polygon[6].Vertex[1].x);
00726         glVertex3fv(&amp;polygon[6].Vertex[1].x);
00727         glVertex3fv(&amp;polygon[6].Vertex[2].x);
00728         glVertex3fv(&amp;polygon[6].Vertex[2].x);
00729         glVertex3fv(&amp;polygon[6].Vertex[0].x);
00730 
00731         glVertex3fv(&amp;polygon[7].Vertex[0].x);
00732         glVertex3fv(&amp;polygon[7].Vertex[1].x);
00733         glVertex3fv(&amp;polygon[7].Vertex[1].x);
00734         glVertex3fv(&amp;polygon[7].Vertex[2].x);
00735         glVertex3fv(&amp;polygon[7].Vertex[2].x);
00736         glVertex3fv(&amp;polygon[7].Vertex[0].x);
00737         <font class="comment">// Right face</font>
00738         glNormal3fv(&amp;polygon[8].Vertex[0].nx);
00739         glVertex3fv(&amp;polygon[8].Vertex[0].x);
00740         glVertex3fv(&amp;polygon[8].Vertex[1].x);
00741         glVertex3fv(&amp;polygon[8].Vertex[1].x);
00742         glVertex3fv(&amp;polygon[8].Vertex[2].x);
00743         glVertex3fv(&amp;polygon[8].Vertex[2].x);
00744         glVertex3fv(&amp;polygon[8].Vertex[0].x);
00745 
00746         glVertex3fv(&amp;polygon[9].Vertex[0].x);
00747         glVertex3fv(&amp;polygon[9].Vertex[1].x);
00748         glVertex3fv(&amp;polygon[9].Vertex[1].x);
00749         glVertex3fv(&amp;polygon[9].Vertex[2].x);
00750         glVertex3fv(&amp;polygon[9].Vertex[2].x);
00751         glVertex3fv(&amp;polygon[9].Vertex[0].x);
00752         <font class="comment">// Left Face</font>
00753         glNormal3fv(&amp;polygon[10].Vertex[0].nx);
00754         glVertex3fv(&amp;polygon[10].Vertex[0].x);
00755         glVertex3fv(&amp;polygon[10].Vertex[1].x);
00756         glVertex3fv(&amp;polygon[10].Vertex[1].x);
00757         glVertex3fv(&amp;polygon[10].Vertex[2].x);
00758         glVertex3fv(&amp;polygon[10].Vertex[2].x);
00759         glVertex3fv(&amp;polygon[10].Vertex[0].x);
00760 
00761         glVertex3fv(&amp;polygon[11].Vertex[0].x);
00762         glVertex3fv(&amp;polygon[11].Vertex[1].x);
00763         glVertex3fv(&amp;polygon[11].Vertex[1].x);
00764         glVertex3fv(&amp;polygon[11].Vertex[2].x);
00765         glVertex3fv(&amp;polygon[11].Vertex[2].x);
00766         glVertex3fv(&amp;polygon[11].Vertex[0].x);
00767     glEnd();
00768     glPopMatrix();
00769     glEnable(GL_LIGHTING);
00770     glEnable(GL_TEXTURE_2D);
00771 
00772 <font class="keywordtype">float</font> mat_ambient[] = { 0.8, 0.5, 0.1, 1.0 };
00773 <font class="keywordtype">float</font> mat_diffuse[] = { 0.8, 0.5, 0.1, 1.0 };
00774 glMaterialfv(GL_FRONT, GL_AMBIENT, mat_ambient);
00775 glMaterialfv(GL_FRONT, GL_DIFFUSE, mat_diffuse);
00776 glDisable(GL_TEXTURE_2D);
00777 glPushMatrix();
00778 glTranslatef(vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].x, vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].y, vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].z);
00779 gluQuadricOrientation(<a class="code" href="Oglmdi2_8cpp.html#a36">sphere</a>, GLU_OUTSIDE);
00780 gluSphere(<a class="code" href="Oglmdi2_8cpp.html#a36">sphere</a>,10.0,20,20);
00781 glPopMatrix();
00782 glEnable(GL_TEXTURE_2D);
00783 
00784 }
00785 
<a name="l00786"></a><a class="code" href="Oglmdi2_8cpp.html#a56">00786</a> LRESULT CALLBACK <a class="code" href="Oglmdi2_8cpp.html#a56">WndProc</a>(HWND hWnd, UINT uMessage, WPARAM wParam, LPARAM lParam)
00787 {
00788     <font class="keywordflow">switch</font>(uMessage)
00789     {
00790         <font class="keywordflow">case</font> WM_CREATE:
00791         {
00792             CLIENTCREATESTRUCT ccs;
00793             <font class="comment">// Find window menu where children will be listed</font>
00794             ccs.hWindowMenu = NULL;
00795 <font class="comment">// If the menus document list for more than 9 children didn't upset the child ID then I would use the line below</font>
00796             <font class="comment">//ccs.hWindowMenu = (HMENU)GetSubMenu(GetMenu(hWnd), 2); // if you use less than 10 windows then use this line</font>
00797             ccs.idFirstChild = ID_MDI_FIRSTCHILD;
00798 
00799             <a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a> = CreateWindowEx(WS_EX_CLIENTEDGE, <font class="stringliteral">"MDICLIENT"</font>, NULL,
00800             WS_CHILD | WS_CLIPCHILDREN | WS_CLIPSIBLINGS,                    <font class="comment">//WS_VSCROLL and WS_HSCROLL do not work properly yet</font>
00801             CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT,
00802             hWnd, (HMENU)ID_MDI_CLIENT, <a class="code" href="Oglmdi2_8cpp.html#a13">g_hInst</a>, (LPVOID)&amp;ccs);
00803 
00804             ShowWindow(<a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>, SW_SHOW);
00805             <font class="keywordflow">return</font> 0;
00806         }
00807         <font class="keywordflow">case</font> WM_COMMAND:
00808         {
00809             <font class="keywordflow">switch</font>(LOWORD(wParam))
00810             {
00811                 <font class="keywordflow">case</font> CM_FILE_EXIT:
00812                     PostMessage(hWnd, WM_CLOSE, 0, 0);
00813                 <font class="keywordflow">break</font>;
00814 
00815                 <font class="keywordflow">case</font> CM_FILE_NEW_3D:
00816                 {
00817                     HWND hChild;
00818 
00819                     <font class="keywordflow">if</font>(<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> &lt; <a class="code" href="Oglmdi2_8cpp.html#a43">g_iMaxChild</a>)      <font class="comment">// If the number of children hasn't reached the maximum</font>
00820                         <a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a>++;                 <font class="comment">// Increment the number of children</font>
00821                     <font class="keywordflow">else</font>
00822                         <font class="keywordflow">break</font>;                         <font class="comment">// Otherwise break out of the routine</font>
00823 
00824                     <font class="keywordtype">char</font> szWindowTitle[] = <font class="stringliteral">"3D"</font>;
00825                     <font class="comment">//sprintf(szWindowTitle, "%d", g_iNumChild - 1);</font>
00826 
00827 <font class="comment">/* One way to create a child window is to send a WM_MDICREATE message to the client</font>
00828 <font class="comment">window and pass it a pointer to a MDICREATESTRUCT. */</font>
00829 
00830 <font class="comment">/*</font>
00831 <font class="comment">                    MDICREATESTRUCT mcs;</font>
00832 <font class="comment">                    mcs.szTitle = szWindowTitle;</font>
00833 <font class="comment">                    mcs.szClass = g_szChildClassName;</font>
00834 <font class="comment">                    mcs.hOwner  = g_hInst;</font>
00835 <font class="comment">                    mcs.x = mcs.cx = CW_USEDEFAULT;</font>
00836 <font class="comment">                    mcs.y = mcs.cy = CW_USEDEFAULT;</font>
00837 <font class="comment">                    mcs.style = MDIS_ALLCHILDSTYLES;</font>
00838 <font class="comment"></font>
00839 <font class="comment">                    hChild = (HWND)SenduMessage(g_hMDIClient, WM_MDICREATE, 0, (LONG)&amp;mcs);</font>
00840 <font class="comment">//*/</font>
00841 
00842 <font class="comment">/* Another way to create a child window is to use CreateWindowEx and set the extended</font>
00843 <font class="comment">windows style  to WS_EX_MDICHILD. I prefer this method as it will allow each child to be created in</font>
00844 <font class="comment">seperate threads in the future. */</font>
00845 
00846 <font class="comment">//*</font>
00847                     CREATESTRUCT cs;
00848                     ZeroMemory(&amp;cs, <font class="keyword">sizeof</font>(CREATESTRUCT));
00849 
00850                     hChild = CreateWindowEx(
00851                     WS_EX_MDICHILD,
00852                     <a class="code" href="Oglmdi2_8cpp.html#a11">g_szChild3DClassName</a>,
00853                     szWindowTitle,
00854                     WS_CHILD | WS_VISIBLE | WS_OVERLAPPEDWINDOW,
00855                     CW_USEDEFAULT,
00856                     CW_USEDEFAULT,
00857                     CW_USEDEFAULT,
00858                     CW_USEDEFAULT,
00859                     <a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>,
00860                     NULL,
00861                     <a class="code" href="Oglmdi2_8cpp.html#a13">g_hInst</a>,
00862                     &amp;cs
00863                     );
00864 <font class="comment">//*/</font>
00865                     <font class="keywordflow">if</font>(!hChild)
00866                     {
00867                         MessageBox(NULL, <font class="stringliteral">"3D Child creation failed."</font>, <font class="stringliteral">"Error"</font>,
00868                         MB_ICONEXCLAMATION | MB_OK);
00869                     }
00870 
00871                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].iType = 1;             <font class="comment">// Set child windows type</font>
00872                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hWnd = hChild;         <font class="comment">// Set child windows handle</font>
00873                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC = GetDC(hChild);   <font class="comment">// Set child windows device context</font>
00874 
00875                     PIXELFORMATDESCRIPTOR pfd;
00876                     ZeroMemory(&amp;pfd, <font class="keyword">sizeof</font>(pfd));
00877                     pfd.nSize = <font class="keyword">sizeof</font>(pfd);
00878                     pfd.nVersion = 1;
00879                     pfd.dwFlags = PFD_DRAW_TO_WINDOW | PFD_SUPPORT_OPENGL | PFD_DOUBLEBUFFER;
00880                     pfd.iPixelType = PFD_TYPE_RGBA;
00881                     pfd.cColorBits = 24;
00882                     pfd.cDepthBits = 16;
00883                     pfd.iLayerType = PFD_MAIN_PLANE;
00884                     <font class="keywordtype">int</font> iFormat = ChoosePixelFormat(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, &amp;pfd);
00885                     SetPixelFormat(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, iFormat, &amp;pfd);               <font class="comment">// Set pixel format for this child</font>
00886 
00887                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hRC = wglCreateContext(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC);  <font class="comment">// Set childs rendering context</font>
00888                     wglMakeCurrent(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hRC);     <font class="comment">// Make this child the current DC and RC</font>
00889                     <a class="code" href="Oglmdi2_8cpp.html#a49">InitGL</a>();              <font class="comment">// Initialize the rendering defaults for this child</font>
00890                 }
00891                 <font class="keywordflow">break</font>;
00892 
00893                 <font class="keywordflow">case</font> CM_FILE_NEW_FRONT:
00894                 {
00895                     HWND hChild;
00896 
00897                     <font class="keywordflow">if</font>(<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> &lt; <a class="code" href="Oglmdi2_8cpp.html#a43">g_iMaxChild</a>)      <font class="comment">// If the number of children hasn't reached the maximum</font>
00898                         <a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a>++;                 <font class="comment">// Increment the number of children</font>
00899                     <font class="keywordflow">else</font>
00900                         <font class="keywordflow">break</font>;                         <font class="comment">// Otherwise break out of the routine</font>
00901 
00902                     <font class="keywordtype">char</font> szWindowTitle[] = <font class="stringliteral">"Front"</font>;
00903                     <font class="comment">//sprintf(szWindowTitle, "%d", g_iNumChild - 1);</font>
00904 
00905                     CREATESTRUCT cs;
00906                     ZeroMemory(&amp;cs, <font class="keyword">sizeof</font>(CREATESTRUCT));
00907 
00908                     hChild = CreateWindowEx(
00909                     WS_EX_MDICHILD,
00910                     <a class="code" href="Oglmdi2_8cpp.html#a12">g_szChild2DClassName</a>,
00911                     szWindowTitle,
00912                     WS_CHILD | WS_VISIBLE | WS_OVERLAPPEDWINDOW,
00913                     CW_USEDEFAULT,
00914                     CW_USEDEFAULT,
00915                     CW_USEDEFAULT,
00916                     CW_USEDEFAULT,
00917                     <a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>,
00918                     NULL,
00919                     <a class="code" href="Oglmdi2_8cpp.html#a13">g_hInst</a>,
00920                     &amp;cs
00921                     );
00922 
00923                     <font class="keywordflow">if</font>(!hChild)
00924                     {
00925                         MessageBox(NULL, <font class="stringliteral">"2D Child creation failed."</font>, <font class="stringliteral">"Error"</font>,
00926                         MB_ICONEXCLAMATION | MB_OK);
00927                     }
00928 
00929                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].iType = 2;             <font class="comment">// Set child windows type</font>
00930                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hWnd = hChild;         <font class="comment">// Set child windows handle</font>
00931                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC = GetDC(hChild);   <font class="comment">// Set child windows device context</font>
00932 
00933                     PIXELFORMATDESCRIPTOR pfd;
00934                     ZeroMemory(&amp;pfd, <font class="keyword">sizeof</font>(pfd));
00935                     pfd.nSize = <font class="keyword">sizeof</font>(pfd);
00936                     pfd.nVersion = 1;
00937                     pfd.dwFlags = PFD_DRAW_TO_WINDOW | PFD_SUPPORT_OPENGL | PFD_DOUBLEBUFFER;
00938                     pfd.iPixelType = PFD_TYPE_RGBA;
00939                     pfd.cColorBits = 24;
00940                     pfd.cDepthBits = 16;
00941                     pfd.iLayerType = PFD_MAIN_PLANE;
00942                     <font class="keywordtype">int</font> iFormat = ChoosePixelFormat(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, &amp;pfd);
00943                     SetPixelFormat(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, iFormat, &amp;pfd);               <font class="comment">// Set pixel format for this child</font>
00944 
00945                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hRC = wglCreateContext(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC);  <font class="comment">// Set childs rendering context</font>
00946                     wglMakeCurrent(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hRC);     <font class="comment">// Make this child the current DC and RC</font>
00947                     <a class="code" href="Oglmdi2_8cpp.html#a49">InitGL</a>();              <font class="comment">// Initialize the rendering defaults for this child</font>
00948                 }
00949                 <font class="keywordflow">break</font>;
00950 
00951                 <font class="keywordflow">case</font> CM_FILE_NEW_TOP:
00952                 {
00953                     HWND hChild;
00954 
00955                     <font class="keywordflow">if</font>(<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> &lt; <a class="code" href="Oglmdi2_8cpp.html#a43">g_iMaxChild</a>)      <font class="comment">// If the number of children hasn't reached the maximum</font>
00956                         <a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a>++;                 <font class="comment">// Increment the number of children</font>
00957                     <font class="keywordflow">else</font>
00958                         <font class="keywordflow">break</font>;                         <font class="comment">// Otherwise break out of the routine</font>
00959 
00960                     <font class="keywordtype">char</font> szWindowTitle[] = <font class="stringliteral">"Top"</font>;
00961                     <font class="comment">//sprintf(szWindowTitle, "%d", g_iNumChild - 1);</font>
00962 
00963                     CREATESTRUCT cs;
00964                     ZeroMemory(&amp;cs, <font class="keyword">sizeof</font>(CREATESTRUCT));
00965 
00966                     hChild = CreateWindowEx(
00967                     WS_EX_MDICHILD,
00968                     <a class="code" href="Oglmdi2_8cpp.html#a12">g_szChild2DClassName</a>,
00969                     szWindowTitle,
00970                     WS_CHILD | WS_VISIBLE | WS_OVERLAPPEDWINDOW,
00971                     CW_USEDEFAULT,
00972                     CW_USEDEFAULT,
00973                     CW_USEDEFAULT,
00974                     CW_USEDEFAULT,
00975                     <a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>,
00976                     NULL,
00977                     <a class="code" href="Oglmdi2_8cpp.html#a13">g_hInst</a>,
00978                     &amp;cs
00979                     );
00980 
00981                     <font class="keywordflow">if</font>(!hChild)
00982                     {
00983                         MessageBox(NULL, <font class="stringliteral">"2D Child creation failed."</font>, <font class="stringliteral">"Error"</font>,
00984                         MB_ICONEXCLAMATION | MB_OK);
00985                     }
00986 
00987                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].iType = 3;             <font class="comment">// Set child windows type</font>
00988                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hWnd = hChild;         <font class="comment">// Set child windows handle</font>
00989                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC = GetDC(hChild);   <font class="comment">// Set child windows device context</font>
00990 
00991                     PIXELFORMATDESCRIPTOR pfd;
00992                     ZeroMemory(&amp;pfd, <font class="keyword">sizeof</font>(pfd));
00993                     pfd.nSize = <font class="keyword">sizeof</font>(pfd);
00994                     pfd.nVersion = 1;
00995                     pfd.dwFlags = PFD_DRAW_TO_WINDOW | PFD_SUPPORT_OPENGL | PFD_DOUBLEBUFFER;
00996                     pfd.iPixelType = PFD_TYPE_RGBA;
00997                     pfd.cColorBits = 24;
00998                     pfd.cDepthBits = 16;
00999                     pfd.iLayerType = PFD_MAIN_PLANE;
01000                     <font class="keywordtype">int</font> iFormat = ChoosePixelFormat(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, &amp;pfd);
01001                     SetPixelFormat(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, iFormat, &amp;pfd);               <font class="comment">// Set pixel format for this child</font>
01002 
01003                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hRC = wglCreateContext(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC);  <font class="comment">// Set childs rendering context</font>
01004                     wglMakeCurrent(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hRC);     <font class="comment">// Make this child the current DC and RC</font>
01005                     <a class="code" href="Oglmdi2_8cpp.html#a49">InitGL</a>();              <font class="comment">// Initialize the rendering defaults for this child</font>
01006                 }
01007                 <font class="keywordflow">break</font>;
01008 
01009                 <font class="keywordflow">case</font> CM_FILE_NEW_LEFT:
01010                 {
01011                     HWND hChild;
01012 
01013                     <font class="keywordflow">if</font>(<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> &lt; <a class="code" href="Oglmdi2_8cpp.html#a43">g_iMaxChild</a>)      <font class="comment">// If the number of children hasn't reached the maximum</font>
01014                         <a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a>++;                 <font class="comment">// Increment the number of children</font>
01015                     <font class="keywordflow">else</font>
01016                         <font class="keywordflow">break</font>;                         <font class="comment">// Otherwise break out of the routine</font>
01017 
01018                     <font class="keywordtype">char</font> szWindowTitle[] = <font class="stringliteral">"Left"</font>;
01019                     <font class="comment">//sprintf(szWindowTitle, "%d", g_iNumChild - 1);</font>
01020 
01021                     CREATESTRUCT cs;
01022                     ZeroMemory(&amp;cs, <font class="keyword">sizeof</font>(CREATESTRUCT));
01023 
01024                     hChild = CreateWindowEx(
01025                     WS_EX_MDICHILD,
01026                     <a class="code" href="Oglmdi2_8cpp.html#a12">g_szChild2DClassName</a>,
01027                     szWindowTitle,
01028                     WS_CHILD | WS_VISIBLE | WS_OVERLAPPEDWINDOW,
01029                     CW_USEDEFAULT,
01030                     CW_USEDEFAULT,
01031                     CW_USEDEFAULT,
01032                     CW_USEDEFAULT,
01033                     <a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>,
01034                     NULL,
01035                     <a class="code" href="Oglmdi2_8cpp.html#a13">g_hInst</a>,
01036                     &amp;cs
01037                     );
01038 
01039                     <font class="keywordflow">if</font>(!hChild)
01040                     {
01041                         MessageBox(NULL, <font class="stringliteral">"2D Child creation failed."</font>, <font class="stringliteral">"Error"</font>,
01042                         MB_ICONEXCLAMATION | MB_OK);
01043                     }
01044 
01045                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].iType = 4;             <font class="comment">// Set child windows type</font>
01046                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hWnd = hChild;         <font class="comment">// Set child windows handle</font>
01047                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC = GetDC(hChild);   <font class="comment">// Set child windows device context</font>
01048 
01049                     PIXELFORMATDESCRIPTOR pfd;
01050                     ZeroMemory(&amp;pfd, <font class="keyword">sizeof</font>(pfd));
01051                     pfd.nSize = <font class="keyword">sizeof</font>(pfd);
01052                     pfd.nVersion = 1;
01053                     pfd.dwFlags = PFD_DRAW_TO_WINDOW | PFD_SUPPORT_OPENGL | PFD_DOUBLEBUFFER;
01054                     pfd.iPixelType = PFD_TYPE_RGBA;
01055                     pfd.cColorBits = 24;
01056                     pfd.cDepthBits = 16;
01057                     pfd.iLayerType = PFD_MAIN_PLANE;
01058                     <font class="keywordtype">int</font> iFormat = ChoosePixelFormat(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, &amp;pfd);
01059                     SetPixelFormat(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, iFormat, &amp;pfd);               <font class="comment">// Set pixel format for this child</font>
01060 
01061                     g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hRC = wglCreateContext(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC);  <font class="comment">// Set childs rendering context</font>
01062                     wglMakeCurrent(g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hDC, g_child[<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> - 1].hRC);     <font class="comment">// Make this child the current DC and RC</font>
01063                     <a class="code" href="Oglmdi2_8cpp.html#a49">InitGL</a>();              <font class="comment">// Initialize the rendering defaults for this child</font>
01064                 }
01065                 <font class="keywordflow">break</font>;
01066 
01067                 <font class="keywordflow">case</font> CM_WINDOW_TILEHORZ:
01068                     PostMessage(<a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>, WM_MDITILE, MDITILE_HORIZONTAL, 0);
01069                 <font class="keywordflow">break</font>;
01070 
01071                 <font class="keywordflow">case</font> CM_WINDOW_TILEVERT:
01072                     PostMessage(<a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>, WM_MDITILE, MDITILE_VERTICAL, 0);
01073                 <font class="keywordflow">break</font>;
01074 
01075                 <font class="keywordflow">case</font> CM_WINDOW_CASCADE:
01076                     PostMessage(<a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>, WM_MDICASCADE, 0, 0);
01077                 <font class="keywordflow">break</font>;
01078 
01079                 <font class="keywordflow">case</font> CM_WINDOW_ARRANGE:
01080                     PostMessage(<a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>, WM_MDIICONARRANGE, 0, 0);
01081                 <font class="keywordflow">break</font>;
01082 
01083                 <font class="keywordflow">default</font>:
01084                 {
01085                     <font class="keywordflow">if</font>(LOWORD(wParam) &gt;= ID_MDI_FIRSTCHILD)
01086                     {
01087                         DefFrameProc(hWnd, <a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>, uMessage, wParam, lParam);
01088                     }
01089                     <font class="keywordflow">else</font>
01090                     {
01091                         HWND hChild;
01092                         hChild = (HWND)SendMessage(<a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>, WM_MDIGETACTIVE, 0, 0);
01093                         <font class="keywordflow">if</font>(hChild)
01094                         {
01095                             SendMessage(hChild, WM_COMMAND, wParam, lParam);
01096                         }
01097                     }
01098                 }
01099             }
01100         }
01101         <font class="keywordflow">break</font>;
01102 
01103         <font class="keywordflow">case</font> WM_CLOSE:
01104         {
01105             <font class="keywordtype">int</font> iLoop;
01106             <font class="keywordflow">if</font>(g_iNumChild)                                      <font class="comment">// If there are any children</font>
01107             {
01108                 <font class="keywordflow">for</font>(iLoop = 0; iLoop &lt; <a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a>; iLoop++)     <font class="comment">// Send all children the WM_CLOSE to free up their DC and RC</font>
01109                 {
01110                     SendMessage(g_child[iLoop].hWnd, WM_CLOSE, 0, 0);
01111                 }
01112             }
01113             <font class="keyword">delete</font>[] g_child;                                     <font class="comment">// Delete the array of children</font>
01114             <font class="keyword">delete</font>[] texture;
01115             <font class="keyword">delete</font>[] vertex;
01116             <font class="keyword">delete</font>[] polygon;
01117             DestroyWindow(hWnd);
01118         }
01119         <font class="keywordflow">break</font>;
01120 
01121         <font class="keywordflow">case</font> WM_DESTROY:
01122             PostQuitMessage(0);
01123         <font class="keywordflow">break</font>;
01124 
01125         <font class="keywordflow">default</font>:
01126             <font class="keywordflow">return</font> DefFrameProc(hWnd, <a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>, uMessage, wParam, lParam);
01127     }
01128     <font class="keywordflow">return</font> 0;
01129 }
01130 
<a name="l01131"></a><a class="code" href="Oglmdi2_8cpp.html#a57">01131</a> LRESULT CALLBACK <a class="code" href="Oglmdi2_8cpp.html#a57">Child3DWndProc</a>(HWND hWnd, UINT uMessage, WPARAM wParam, LPARAM lParam)
01132 {
01133     <font class="keywordflow">switch</font>(uMessage)
01134     {
01135         <font class="keywordflow">case</font> WM_KEYDOWN:
01136             <a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[wParam] = <a class="code" href="glfont_8h.html#a0">TRUE</a>;
01137         <font class="keywordflow">break</font>;
01138 
01139         <font class="keywordflow">case</font> WM_KEYUP:
01140             <a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[wParam] = <a class="code" href="glfont_8h.html#a1">FALSE</a>;
01141         <font class="keywordflow">break</font>;
01142         <font class="keywordflow">case</font> WM_LBUTTONDOWN:
01143             <a class="code" href="Oglmdi2_8cpp.html#a24">g_bMouseDrag</a> = 1;                                     <font class="comment">// Set mouse flag</font>
01144             <a class="code" href="Oglmdi2_8cpp.html#a25">g_iMouseLastX</a> = LOWORD(lParam);                       <font class="comment">// Get mouse position</font>
01145             <a class="code" href="Oglmdi2_8cpp.html#a26">g_iMouseLastY</a> = HIWORD(lParam);
01146             SetCapture(hWnd);                                     <font class="comment">// Capture the mouse</font>
01147         <font class="keywordflow">break</font>;
01148 
01149         <font class="keywordflow">case</font> WM_MOUSEMOVE:
01150             <font class="keywordflow">if</font>(g_bMouseDrag)                                       <font class="comment">// If mouse flag set</font>
01151             {
01152                 <a class="code" href="Oglmdi2_8cpp.html#a27">g_iMouseDeltaX</a> = LOWORD(lParam) - <a class="code" href="Oglmdi2_8cpp.html#a25">g_iMouseLastX</a>;   <font class="comment">// Get mouse deltas</font>
01153                 <a class="code" href="Oglmdi2_8cpp.html#a28">g_iMouseDeltaY</a> = HIWORD(lParam) - <a class="code" href="Oglmdi2_8cpp.html#a26">g_iMouseLastY</a>;
01154                 <a class="code" href="Oglmdi2_8cpp.html#a25">g_iMouseLastX</a> = LOWORD(lParam);                    <font class="comment">// Get new mouse position</font>
01155                 <a class="code" href="Oglmdi2_8cpp.html#a26">g_iMouseLastY</a> = HIWORD(lParam);
01156             }
01157         <font class="keywordflow">break</font>;
01158 
01159         <font class="keywordflow">case</font> WM_LBUTTONUP:
01160             <a class="code" href="Oglmdi2_8cpp.html#a24">g_bMouseDrag</a> = 0;                                      <font class="comment">// Clear mouse flag</font>
01161             ReleaseCapture();                                      <font class="comment">// Release the mouse capture</font>
01162         <font class="keywordflow">break</font>;
01163 
01164 <font class="comment">/*</font>
01165 <font class="comment">        //This msg isn't posted if the mouse is captured</font>
01166 <font class="comment">        case WM_NCMOUSEMOVE:</font>
01167 <font class="comment">        {</font>
01168 <font class="comment">            POINTS pts;</font>
01169 <font class="comment">            if(g_bMouseDrag)</font>
01170 <font class="comment">            {</font>
01171 <font class="comment">                pts = MAKEPOINTS(lParam);</font>
01172 <font class="comment">                g_iMouseDeltaX = pts.x - g_iMouseLastX;</font>
01173 <font class="comment">                g_iMouseDeltaY = pts.y - g_iMouseLastY;</font>
01174 <font class="comment">                g_iMouseLastX = pts.x;</font>
01175 <font class="comment">                g_iMouseLastY = pts.y;</font>
01176 <font class="comment">            }</font>
01177 <font class="comment">        }</font>
01178 <font class="comment">        break;</font>
01179 <font class="comment">//*/</font>
01180 
01181 <font class="comment">/* The following code paints the child window when necessary but isn't needed as we</font>
01182 <font class="comment">repaint all of them each frame. */</font>
01183 
01184 <font class="comment">/*</font>
01185 <font class="comment">        case WM_PAINT:</font>
01186 <font class="comment">        {</font>
01187 <font class="comment">            int iThisChild;</font>
01188 <font class="comment">            PAINTSTRUCT ps;</font>
01189 <font class="comment">            BeginPaint(hWnd, &amp;ps);</font>
01190 <font class="comment">            iThisChild = GetDlgCtrlID(hWnd) - ID_MDI_FIRSTCHILD;</font>
01191 <font class="comment">            wglMakeCurrent(g_child[iThisChild].hDC, g_child[iThisChild].hRC);</font>
01192 <font class="comment">            GetClientRect(hWnd, &amp;g_rectChild);</font>
01193 <font class="comment">            if(g_rectChild.right &gt; 0 &amp;&amp; g_rectChild.bottom &gt; 0)</font>
01194 <font class="comment">                SetProjection(g_rectChild.right, g_rectChild.bottom);</font>
01195 <font class="comment">            DrawGLScene();</font>
01196 <font class="comment">            glFlush();</font>
01197 <font class="comment">            SwapBuffers(hDC);</font>
01198 <font class="comment">            EndPaint(hWnd, &amp;ps);</font>
01199 <font class="comment">        }</font>
01200 <font class="comment">        break;</font>
01201 <font class="comment">//*/</font>
01202         <font class="keywordflow">case</font> WM_CLOSE:
01203             <a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a>--;                                          <font class="comment">// Decrement the number of child windows</font>
01204             <font class="keywordflow">if</font>(<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> == 0)                                    <font class="comment">// If this is the last child window then just free the DC and RC</font>
01205             {
01206                 wglMakeCurrent( NULL, NULL );
01207                 ReleaseDC(g_child[0].hWnd, g_child[0].hDC);
01208                 wglDeleteContext(g_child[0].hRC);
01209             }
01210             <font class="keywordflow">else</font>
01211             {
01212                 <font class="keywordtype">int</font> iLoop;
01213                 <font class="keywordtype">int</font> iThisChild;
01214                 <font class="keywordtype">char</font> szWindowTitle[20];
01215                 iThisChild = GetDlgCtrlID(hWnd) - ID_MDI_FIRSTCHILD;
01216                 ReleaseDC(g_child[iThisChild].hWnd, g_child[iThisChild].hDC);    <font class="comment">// Free this childs DC and RC</font>
01217                 wglDeleteContext(g_child[iThisChild].hRC);
01218                 <font class="keywordflow">if</font>(iThisChild != <a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a>)                        <font class="comment">// If this child isn't the last in the array of children</font>
01219                 {
01220                     <font class="keywordflow">for</font> (iLoop = iThisChild; iLoop &lt; (g_iNumChild); iLoop++)   <font class="comment">// Loop from this child to the end of the array</font>
01221                     {
01222                         g_child[iLoop] = g_child[iLoop + 1];         <font class="comment">// Shift the children forward in the array</font>
01223                         sprintf(szWindowTitle, <font class="stringliteral">"%d"</font>, iLoop);
01224                         SetWindowText(g_child[iLoop].hWnd, szWindowTitle);  <font class="comment">// Renumber the children</font>
01225                     }
01226                 }
01227             }
01228         <font class="keywordflow">break</font>;
01229 
01230         <font class="keywordflow">case</font> WM_MDIACTIVATE:
01231         {
01232             HMENU hMenu, hFileMenu;
01233             UINT uEnableFlag;
01234 
01235             hMenu = GetMenu(<a class="code" href="Oglmdi2_8cpp.html#a15">g_hMainWindow</a>);
01236             <font class="keywordflow">if</font>(hWnd == (HWND)lParam)                               <font class="comment">//being activated</font>
01237             {
01238                 uEnableFlag = MF_ENABLED;
01239             }
01240             <font class="keywordflow">else</font>
01241             {
01242                 uEnableFlag = MF_GRAYED;                           <font class="comment">//being de-activated</font>
01243             }
01244             EnableMenuItem(hMenu, 1, MF_BYPOSITION | uEnableFlag);
01245             EnableMenuItem(hMenu, 2, MF_BYPOSITION | uEnableFlag);
01246 
01247             hFileMenu = GetSubMenu(hMenu, 0);
01248             EnableMenuItem(hFileMenu, CM_FILE_SAVE, MF_BYCOMMAND | uEnableFlag);
01249             EnableMenuItem(hFileMenu, CM_FILE_SAVEAS, MF_BYCOMMAND | uEnableFlag);
01250 
01251             DrawMenuBar(<a class="code" href="Oglmdi2_8cpp.html#a15">g_hMainWindow</a>);
01252         }
01253         <font class="keywordflow">break</font>;
01254 
01255         <font class="keywordflow">case</font> WM_COMMAND:
01256             <font class="keywordflow">switch</font>(LOWORD(wParam))
01257             {
01258 <font class="comment">//              case CM_FILE_SAVE: etc</font>
01259             }
01260         <font class="keywordflow">return</font> 0;
01261     }
01262     <font class="keywordflow">return</font> DefMDIChildProc(hWnd, uMessage, wParam, lParam);
01263 }
01264 
<a name="l01265"></a><a class="code" href="Oglmdi2_8cpp.html#a58">01265</a> <font class="keywordtype">void</font> <a class="code" href="Oglmdi2_8cpp.html#a58">DrawWin32Text</a>(HDC hDC, <font class="keywordtype">int</font> right, <font class="keywordtype">int</font> bottom, <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y)
01266 {
01267     <a class="code" href="Oglmdi2_8cpp.html#a2">colorRGB</a> = RGB(255, 255, 255);
01268     SetTextColor(hDC, <a class="code" href="Oglmdi2_8cpp.html#a2">colorRGB</a>);              <font class="comment">// Sets the text color</font>
01269     SetBkMode(hDC, TRANSPARENT);              <font class="comment">// Sets the text background to transparent</font>
01270     <a class="code" href="Oglmdi2_8cpp.html#a3">MainRect</a>.left = 0;                        <font class="comment">// Set the whole screen as the drawing area</font>
01271     <a class="code" href="Oglmdi2_8cpp.html#a3">MainRect</a>.top = 0;
01272     <a class="code" href="Oglmdi2_8cpp.html#a3">MainRect</a>.bottom = bottom;
01273     <a class="code" href="Oglmdi2_8cpp.html#a3">MainRect</a>.right = right;
01274     ZeroMemory(&amp;<a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>, <font class="keyword">sizeof</font>(<a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>));
01275     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfHeight = 14;                    <font class="comment">// Font height</font>
01276     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfWidth = 8;                   <font class="comment">// Font width</font>
01277     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfEscapement = 0;              <font class="comment">// Text rotation for true type fonts. If this one is set then also set the next line to the same value</font>
01278     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfOrientation = 0;
01279     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfWeight = FW_NORMAL;
01280     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfItalic = 0;
01281     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfUnderline = 0;
01282     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfStrikeOut = 0;
01283     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfCharSet = DEFAULT_CHARSET;
01284     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfOutPrecision = OUT_DEFAULT_PRECIS;
01285     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfClipPrecision = CLIP_DEFAULT_PRECIS;
01286     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfQuality = DEFAULT_QUALITY;
01287     <a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfPitchAndFamily = DEFAULT_PITCH;
01288     sprintf(<a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>.lfFaceName, <font class="stringliteral">"%s"</font>, <font class="stringliteral">"Arial"</font>);
01289     <a class="code" href="Oglmdi2_8cpp.html#a5">hFont</a> = CreateFontIndirect(&amp;<a class="code" href="Oglmdi2_8cpp.html#a4">LogFont</a>);
01290     SaveDC(hDC);
01291     <a class="code" href="Oglmdi2_8cpp.html#a6">hOldFont</a> = (HFONT)SelectObject(hDC, (HFONT)<a class="code" href="Oglmdi2_8cpp.html#a5">hFont</a>);
01292     <font class="keywordtype">char</font> tempstring[20];
01293     sprintf(tempstring, <font class="stringliteral">"%d"</font>, <a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a>);
01294     DrawText(hDC, tempstring, 11, &amp;<a class="code" href="Oglmdi2_8cpp.html#a3">MainRect</a>, DT_NOCLIP | DT_LEFT | DT_BOTTOM | DT_WORDBREAK | DT_EDITCONTROL);
01295     SelectObject(hDC, (HFONT)<a class="code" href="Oglmdi2_8cpp.html#a6">hOldFont</a>);
01296     DeleteObject(<a class="code" href="Oglmdi2_8cpp.html#a5">hFont</a>);
01297     RestoreDC(hDC, -1);
01298 }
01299 
<a name="l01300"></a><a class="code" href="Oglmdi2_8cpp.html#a59">01300</a> LRESULT CALLBACK <a class="code" href="Oglmdi2_8cpp.html#a59">Child2DWndProc</a>(HWND hWnd, UINT uMessage, WPARAM wParam, LPARAM lParam)
01301 {
01302     <font class="keywordflow">switch</font>(uMessage)
01303     {
01304         <font class="keywordflow">case</font> WM_SIZE:
01305         {
01306             <font class="keywordflow">if</font>(wParam != SIZE_MINIMIZED)
01307             {
01308                 RECT WindowRect;
01309                 GetClientRect(hWnd, &amp;WindowRect);
01310                 <font class="keywordtype">int</font> iThisChild = GetDlgCtrlID(hWnd) - ID_MDI_FIRSTCHILD;
01311                 <font class="keywordflow">if</font>(g_child[iThisChild].<a class="code" href="structCHILD.html#m0">iType</a> == 2)
01312                 {
01313                     <a class="code" href="Oglmdi2_8cpp.html#a34">TopDepth</a> = -0.5 * WindowRect.bottom + 10;
01314                     <a class="code" href="Oglmdi2_8cpp.html#a35">LeftDepth</a> = -0.5 * WindowRect.right + 10;
01315                 }
01316                 <font class="keywordflow">if</font>(g_child[iThisChild].<a class="code" href="structCHILD.html#m0">iType</a> == 3)
01317                 {
01318                     <a class="code" href="Oglmdi2_8cpp.html#a33">FrontDepth</a> = 0.5 * WindowRect.bottom - 10;
01319                     <a class="code" href="Oglmdi2_8cpp.html#a35">LeftDepth</a> = -0.5 * WindowRect.right + 10;
01320                 }
01321                 <font class="keywordflow">if</font>(g_child[iThisChild].<a class="code" href="structCHILD.html#m0">iType</a> == 4)
01322                 {
01323                     <a class="code" href="Oglmdi2_8cpp.html#a33">FrontDepth</a> = -0.5 * WindowRect.right + 10;
01324                     <a class="code" href="Oglmdi2_8cpp.html#a34">TopDepth</a> = -0.5 * WindowRect.bottom + 10;
01325                 }
01326             }
01327         }
01328         <font class="keywordflow">break</font>;
01329 
01330         <font class="keywordflow">case</font> WM_KEYDOWN:
01331             <a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[wParam] = <a class="code" href="glfont_8h.html#a0">TRUE</a>;
01332         <font class="keywordflow">break</font>;
01333 
01334         <font class="keywordflow">case</font> WM_KEYUP:
01335             <a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[wParam] = <a class="code" href="glfont_8h.html#a1">FALSE</a>;
01336         <font class="keywordflow">break</font>;
01337 
01338         <font class="keywordflow">case</font> WM_LBUTTONDOWN:
01339             <a class="code" href="Oglmdi2_8cpp.html#a37">g_bMouseDrag2</a> = 1;                                     <font class="comment">// Set mouse flag</font>
01340             <a class="code" href="Oglmdi2_8cpp.html#a38">g_iMouseLastX2</a> = LOWORD(lParam);                       <font class="comment">// Get mouse position</font>
01341             <a class="code" href="Oglmdi2_8cpp.html#a39">g_iMouseLastY2</a> = HIWORD(lParam);
01342             SetCapture(hWnd);                                     <font class="comment">// Capture the mouse</font>
01343         <font class="keywordflow">break</font>;
01344 
01345         <font class="keywordflow">case</font> WM_LBUTTONUP:
01346             <a class="code" href="Oglmdi2_8cpp.html#a37">g_bMouseDrag2</a> = 0;                                      <font class="comment">// Clear mouse flag</font>
01347             ReleaseCapture();                                      <font class="comment">// Release the mouse capture</font>
01348         <font class="keywordflow">break</font>;
01349 
01350         <font class="keywordflow">case</font> WM_MOUSEMOVE:
01351         {
01352             RECT WindowRect;
01353             GetClientRect(hWnd, &amp;WindowRect);
01354             <a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a> = LOWORD(lParam);
01355             <a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a> = HIWORD(lParam);
01356             <font class="keywordtype">int</font> iThisChild = GetDlgCtrlID(hWnd) - ID_MDI_FIRSTCHILD;
01357             <font class="keywordflow">if</font>(g_bMouseDrag2)                                       <font class="comment">// If mouse flag set</font>
01358             {
01359                 <font class="keywordflow">if</font> (<a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a> &lt; WindowRect.left || <a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a> &gt; WindowRect.right)
01360                 {
01361                     <a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a> = <a class="code" href="Oglmdi2_8cpp.html#a38">g_iMouseLastX2</a>;
01362                 }
01363                 <font class="keywordflow">if</font> (<a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a> &lt; WindowRect.top || <a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a> &gt; WindowRect.bottom)
01364                 {
01365                     <a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a> = <a class="code" href="Oglmdi2_8cpp.html#a39">g_iMouseLastY2</a>;
01366                 }
01367                 <a class="code" href="Oglmdi2_8cpp.html#a40">g_iMouseDeltaX2</a> = <a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a> - <a class="code" href="Oglmdi2_8cpp.html#a38">g_iMouseLastX2</a>;   <font class="comment">// Get mouse deltas</font>
01368                 <a class="code" href="Oglmdi2_8cpp.html#a41">g_iMouseDeltaY2</a> = <a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a> - <a class="code" href="Oglmdi2_8cpp.html#a39">g_iMouseLastY2</a>;
01369                 <a class="code" href="Oglmdi2_8cpp.html#a38">g_iMouseLastX2</a> = <a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a>;                    <font class="comment">// Get new mouse position</font>
01370                 <a class="code" href="Oglmdi2_8cpp.html#a39">g_iMouseLastY2</a> = <a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a>;
01371                 <font class="keywordflow">if</font>(g_child[iThisChild].<a class="code" href="structCHILD.html#m0">iType</a> == 2)
01372                 {
01373                     vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].x += (float)<a class="code" href="Oglmdi2_8cpp.html#a40">g_iMouseDeltaX2</a> * 1.0;   <font class="comment">// Apply mouse deltas to cube rotation values</font>
01374                     vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].y -= (float)<a class="code" href="Oglmdi2_8cpp.html#a41">g_iMouseDeltaY2</a> * 1.0;
01375                 }
01376                 <font class="keywordflow">if</font>(g_child[iThisChild].<a class="code" href="structCHILD.html#m0">iType</a> == 3)
01377                 {
01378                     vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].x += (float)<a class="code" href="Oglmdi2_8cpp.html#a40">g_iMouseDeltaX2</a> * 1.0;   <font class="comment">// Apply mouse deltas to cube rotation values</font>
01379                     vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].z += (float)<a class="code" href="Oglmdi2_8cpp.html#a41">g_iMouseDeltaY2</a> * 1.0;
01380                 }
01381                 <font class="keywordflow">if</font>(g_child[iThisChild].<a class="code" href="structCHILD.html#m0">iType</a> == 4)
01382                 {
01383                     vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].z += (float)<a class="code" href="Oglmdi2_8cpp.html#a40">g_iMouseDeltaX2</a> * 1.0;   <font class="comment">// Apply mouse deltas to cube rotation values</font>
01384                     vertex[<a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a>].y -= (float)<a class="code" href="Oglmdi2_8cpp.html#a41">g_iMouseDeltaY2</a> * 1.0;
01385                 }
01386                 <a class="code" href="Oglmdi2_8cpp.html#a48">SetPolygons</a>();
01387             }
01388 
01389             <font class="keywordflow">if</font>(!<a class="code" href="Oglmdi2_8cpp.html#a37">g_bMouseDrag2</a>)
01390             {
01391             <a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a> = (int)(LOWORD(lParam) + (-0.5 * WindowRect.right));
01392             <font class="keywordflow">if</font>(g_child[iThisChild].<a class="code" href="structCHILD.html#m0">iType</a> == 3)
01393                 <a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a> = (int)(HIWORD(lParam) + (-0.5 * WindowRect.bottom));
01394             <font class="keywordflow">else</font>
01395                 <a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a> = (int)(-1 * (HIWORD(lParam) + (-0.5 * WindowRect.bottom)));
01396             <a class="code" href="Oglmdi2_8cpp.html#a30">ShortestDistance</a> = 10000;
01397             <font class="keywordtype">int</font> Loop;
01398             <font class="keywordtype">int</font> TempX;
01399             <font class="keywordtype">int</font> TempY;
01400             <font class="keywordflow">for</font>(Loop = 0; Loop &lt; 8; Loop++)
01401             {
01402                 iThisChild = GetDlgCtrlID(hWnd) - ID_MDI_FIRSTCHILD;
01403                 <font class="keywordflow">if</font>(g_child[iThisChild].<a class="code" href="structCHILD.html#m0">iType</a> == 2)
01404                 {
01405                     TempX = (int)(<a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a> - vertex[Loop].<a class="code" href="classVERTEX.html#m1">x</a>);
01406                     TempY = (int)(<a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a> - vertex[Loop].<a class="code" href="classVERTEX.html#m2">y</a>);
01407                 }
01408                 <font class="keywordflow">if</font>(g_child[iThisChild].<a class="code" href="structCHILD.html#m0">iType</a> == 3)
01409                 {
01410                     TempX = (int)(<a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a> - vertex[Loop].<a class="code" href="classVERTEX.html#m1">x</a>);
01411                     TempY = (int)(<a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a> - vertex[Loop].<a class="code" href="classVERTEX.html#m3">z</a>);
01412                 }
01413                 <font class="keywordflow">if</font>(g_child[iThisChild].<a class="code" href="structCHILD.html#m0">iType</a> == 4)
01414                 {
01415                     TempX = (int)(<a class="code" href="Oglmdi2_8cpp.html#a31">MouseX</a> - vertex[Loop].<a class="code" href="classVERTEX.html#m3">z</a>);
01416                     TempY = (int)(<a class="code" href="Oglmdi2_8cpp.html#a32">MouseY</a> - vertex[Loop].<a class="code" href="classVERTEX.html#m2">y</a>);
01417                 }
01418                 <font class="keywordflow">if</font>(sqrt((TempX * TempX) + (TempY * TempY)) &lt; <a class="code" href="Oglmdi2_8cpp.html#a30">ShortestDistance</a>)
01419                 {
01420                     <a class="code" href="Oglmdi2_8cpp.html#a30">ShortestDistance</a> = (int)(sqrt((TempX * TempX) + (TempY * TempY)));
01421                     <a class="code" href="Oglmdi2_8cpp.html#a29">VertexNumber</a> = Loop;
01422                 }
01423             }
01424 
01425             <font class="comment">//int iThisChild = GetDlgCtrlID(hWnd) - ID_MDI_FIRSTCHILD;</font>
01426             <font class="comment">//DrawWin32Text(g_child[iThisChild].hDC, WindowRect.right, WindowRect.bottom, 1, 1);</font>
01427             }
01428             }
01429             <font class="keywordflow">break</font>;
01430 
01431         <font class="keywordflow">case</font> WM_CLOSE:
01432             <a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a>--;                                          <font class="comment">// Decrement the number of child windows</font>
01433             <font class="keywordflow">if</font>(<a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a> == 0)                                    <font class="comment">// If this is the last child window then just free the DC and RC</font>
01434             {
01435                 wglMakeCurrent( NULL, NULL );
01436                 ReleaseDC(g_child[0].hWnd, g_child[0].hDC);
01437                 wglDeleteContext(g_child[0].hRC);
01438             }
01439             <font class="keywordflow">else</font>
01440             {
01441                 <font class="keywordtype">int</font> iLoop;
01442                 <font class="keywordtype">int</font> iThisChild;
01443                 <font class="keywordtype">char</font> szWindowTitle[20];
01444                 iThisChild = GetDlgCtrlID(hWnd) - ID_MDI_FIRSTCHILD;
01445                 ReleaseDC(g_child[iThisChild].hWnd, g_child[iThisChild].hDC);    <font class="comment">// Free this childs DC and RC</font>
01446                 wglDeleteContext(g_child[iThisChild].hRC);
01447                 <font class="keywordflow">if</font>(iThisChild != <a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a>)                        <font class="comment">// If this child isn't the last in the array of children</font>
01448                 {
01449                     <font class="keywordflow">for</font> (iLoop = iThisChild; iLoop &lt; (g_iNumChild); iLoop++)   <font class="comment">// Loop from this child to the end of the array</font>
01450                     {
01451                         g_child[iLoop] = g_child[iLoop + 1];         <font class="comment">// Shift the children forward in the array</font>
01452                         sprintf(szWindowTitle, <font class="stringliteral">"%d"</font>, iLoop);
01453                         SetWindowText(g_child[iLoop].hWnd, szWindowTitle);  <font class="comment">// Renumber the children</font>
01454                     }
01455                 }
01456             }
01457         <font class="keywordflow">break</font>;
01458 
01459         <font class="keywordflow">case</font> WM_MDIACTIVATE:
01460         {
01461             HMENU hMenu, hFileMenu;
01462             UINT uEnableFlag;
01463 
01464             hMenu = GetMenu(<a class="code" href="Oglmdi2_8cpp.html#a15">g_hMainWindow</a>);
01465             <font class="keywordflow">if</font>(hWnd == (HWND)lParam)                               <font class="comment">//being activated</font>
01466             {
01467                 uEnableFlag = MF_ENABLED;
01468             }
01469             <font class="keywordflow">else</font>
01470             {
01471                 uEnableFlag = MF_GRAYED;                           <font class="comment">//being de-activated</font>
01472             }
01473             EnableMenuItem(hMenu, 1, MF_BYPOSITION | uEnableFlag);
01474             EnableMenuItem(hMenu, 2, MF_BYPOSITION | uEnableFlag);
01475 
01476             hFileMenu = GetSubMenu(hMenu, 0);
01477             EnableMenuItem(hFileMenu, CM_FILE_SAVE, MF_BYCOMMAND | uEnableFlag);
01478             EnableMenuItem(hFileMenu, CM_FILE_SAVEAS, MF_BYCOMMAND | uEnableFlag);
01479 
01480             DrawMenuBar(<a class="code" href="Oglmdi2_8cpp.html#a15">g_hMainWindow</a>);
01481         }
01482         <font class="keywordflow">break</font>;
01483 
01484         <font class="keywordflow">case</font> WM_COMMAND:
01485             <font class="keywordflow">switch</font>(LOWORD(wParam))
01486             {
01487 <font class="comment">//              case CM_FILE_SAVE: etc</font>
01488             }
01489         <font class="keywordflow">return</font> 0;
01490     }
01491     <font class="keywordflow">return</font> DefMDIChildProc(hWnd, uMessage, wParam, lParam);
01492 }
01493 
<a name="l01494"></a><a class="code" href="Oglmdi2_8cpp.html#a60">01494</a> <font class="keywordtype">int</font> WINAPI <a class="code" href="Oglmdi2_8cpp.html#a60">WinMain</a>(HINSTANCE hInstance, HINSTANCE, LPSTR, <font class="keywordtype">int</font> nCmdShow)
01495 {
01496     MSG Msg;
01497     WNDCLASSEX wc;
01498     <a class="code" href="Oglmdi2_8cpp.html#a13">g_hInst</a> = hInstance;
01499 
01500     <font class="comment">// Create an OpenGL compatible window class</font>
01501     wc.cbSize = <font class="keyword">sizeof</font>(WNDCLASSEX);
01502     wc.style = CS_HREDRAW | CS_VREDRAW | CS_OWNDC | CS_DBLCLKS;
01503     wc.lpfnWndProc = (WNDPROC)<a class="code" href="Oglmdi2_8cpp.html#a57">Child3DWndProc</a>;
01504     wc.cbClsExtra = 0;
01505     wc.cbWndExtra = 0;
01506     wc.hInstance = hInstance;
01507     wc.hIcon = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_CHILDICON));
01508     wc.hCursor = LoadCursor(NULL, IDC_ARROW);
01509     wc.hbrBackground = (HBRUSH)(COLOR_3DSHADOW+1);    <font class="comment">// Background color (Only seen if OGL fails)</font>
01510     wc.lpszMenuName = NULL;
01511     wc.lpszClassName = <a class="code" href="Oglmdi2_8cpp.html#a11">g_szChild3DClassName</a>;
01512     wc.hIconSm = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_CHILDICON));
01513 
01514     <font class="keywordflow">if</font>(!RegisterClassEx(&amp;wc))
01515     {
01516         MessageBox(NULL,<font class="stringliteral">"Failed to register the child window."</font>,<font class="stringliteral">"Error"</font>,MB_OK|MB_ICONEXCLAMATION);
01517         <font class="keywordflow">return</font> <a class="code" href="glfont_8h.html#a1">FALSE</a>;
01518     }
01519 
01520     <font class="comment">// Create an OpenGL compatible window class</font>
01521     wc.cbSize = <font class="keyword">sizeof</font>(WNDCLASSEX);
01522     wc.style = CS_HREDRAW | CS_VREDRAW | CS_OWNDC | CS_DBLCLKS;
01523     wc.lpfnWndProc = (WNDPROC)<a class="code" href="Oglmdi2_8cpp.html#a59">Child2DWndProc</a>;
01524     wc.cbClsExtra = 0;
01525     wc.cbWndExtra = 0;
01526     wc.hInstance = hInstance;
01527     wc.hIcon = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_CHILDICON));
01528     wc.hCursor = LoadCursor(NULL, IDC_ARROW);
01529     wc.hbrBackground = (HBRUSH)(COLOR_3DSHADOW+1);    <font class="comment">// Background color (Only seen if OGL fails)</font>
01530     wc.lpszMenuName = NULL;
01531     wc.lpszClassName = <a class="code" href="Oglmdi2_8cpp.html#a12">g_szChild2DClassName</a>;
01532     wc.hIconSm = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_CHILDICON));
01533 
01534     <font class="keywordflow">if</font>(!RegisterClassEx(&amp;wc))
01535     {
01536         MessageBox(NULL,<font class="stringliteral">"Failed to register the child window."</font>,<font class="stringliteral">"Error"</font>,MB_OK|MB_ICONEXCLAMATION);
01537         <font class="keywordflow">return</font> <a class="code" href="glfont_8h.html#a1">FALSE</a>;
01538     }
01539 
01540     <font class="comment">// Create the frame window</font>
01541     wc.cbSize = <font class="keyword">sizeof</font>(WNDCLASSEX);
01542     wc.style = CS_HREDRAW | CS_VREDRAW;
01543     wc.lpfnWndProc = (WNDPROC)<a class="code" href="Oglmdi2_8cpp.html#a56">WndProc</a>;
01544     wc.cbClsExtra = 0;
01545     wc.cbWndExtra = 0;
01546     wc.hInstance = hInstance;
01547     wc.hIcon = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_MYICON));
01548     wc.hCursor = LoadCursor(NULL, IDC_ARROW);
01549     wc.hbrBackground = (HBRUSH)(COLOR_3DSHADOW+1);
01550     wc.lpszMenuName = <font class="stringliteral">"MAIN"</font>;
01551     wc.lpszClassName = <a class="code" href="Oglmdi2_8cpp.html#a10">g_szMainClassName</a>;
01552     wc.hIconSm = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_MYICON));
01553 
01554     <font class="keywordflow">if</font>(!RegisterClassEx(&amp;wc))
01555     {
01556         MessageBox(0, <font class="stringliteral">"Failed to register the main window."</font>, <font class="stringliteral">"Error"</font>,
01557         MB_ICONEXCLAMATION | MB_OK);
01558         <font class="keywordflow">return</font> -1;
01559     }
01560 
01561     <a class="code" href="Oglmdi2_8cpp.html#a15">g_hMainWindow</a> = CreateWindowEx(WS_EX_LEFT, <a class="code" href="Oglmdi2_8cpp.html#a10">g_szMainClassName</a>, <font class="stringliteral">"Al's OpenGL MDI Example"</font>,
01562     WS_OVERLAPPEDWINDOW | WS_CLIPCHILDREN,
01563     CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT,
01564     NULL, NULL, hInstance, NULL);
01565 
01566     <font class="keywordflow">if</font>(<a class="code" href="Oglmdi2_8cpp.html#a15">g_hMainWindow</a> == NULL)
01567     {
01568         MessageBox(0, <font class="stringliteral">"Failed to create window."</font>, <font class="stringliteral">"ERROR"</font>, MB_ICONEXCLAMATION | MB_OK);
01569         <font class="keywordflow">return</font> -1;
01570     }
01571 
01572     ShowWindow(<a class="code" href="Oglmdi2_8cpp.html#a15">g_hMainWindow</a>, nCmdShow);
01573     UpdateWindow(<a class="code" href="Oglmdi2_8cpp.html#a15">g_hMainWindow</a>);
01574     <a class="code" href="Oglmdi2_8cpp.html#a47">SetVertices</a>();
01575     <a class="code" href="Oglmdi2_8cpp.html#a48">SetPolygons</a>();
01576 
01577     <font class="keywordtype">int</font> iLoop;
01578     <font class="keywordflow">while</font>(GetMessage(&amp;Msg, NULL, 0, 0))
01579     {
01580         <font class="keywordflow">if</font>(!TranslateMDISysAccel(<a class="code" href="Oglmdi2_8cpp.html#a14">g_hMDIClient</a>, &amp;Msg))
01581         {
01582             TranslateMessage(&amp;Msg);
01583             DispatchMessage(&amp;Msg);
01584         }
01585 
01586         <font class="keywordflow">if</font>(g_iNumChild)                                        <font class="comment">// If we have some children</font>
01587         {
01588             <font class="keywordflow">for</font>(iLoop = 0; iLoop &lt; <a class="code" href="Oglmdi2_8cpp.html#a44">g_iNumChild</a>; iLoop++)       <font class="comment">// Loop through all children</font>
01589             {
01590                 <font class="keywordflow">if</font>(!IsIconic(g_child[iLoop].hWnd))             <font class="comment">// If child isn't iconic (minimized)</font>
01591                 {
01592                     wglMakeCurrent(g_child[iLoop].hDC, g_child[iLoop].hRC);  <font class="comment">// Make them the current DC and RC</font>
01593                     GetClientRect(g_child[iLoop].hWnd, &amp;<a class="code" href="Oglmdi2_8cpp.html#a16">g_rectChild</a>);
01594                     <font class="keywordflow">if</font>(<a class="code" href="Oglmdi2_8cpp.html#a16">g_rectChild</a>.right &gt; 0 &amp;&amp; <a class="code" href="Oglmdi2_8cpp.html#a16">g_rectChild</a>.bottom &gt; 0)
01595                     {
01596                         <font class="keywordflow">if</font>(g_child[iLoop].<a class="code" href="structCHILD.html#m0">iType</a> == 1)
01597                         {
01598                             <a class="code" href="Oglmdi2_8cpp.html#a50">Set3DProjection</a>(<a class="code" href="Oglmdi2_8cpp.html#a16">g_rectChild</a>.right, <a class="code" href="Oglmdi2_8cpp.html#a16">g_rectChild</a>.bottom);<font class="comment">// Set the childs projection matrix</font>
01599                             <a class="code" href="Oglmdi2_8cpp.html#a52">Draw3DScene</a>();
01600                         }
01601                         <font class="keywordflow">else</font>
01602                         {
01603                             <a class="code" href="Oglmdi2_8cpp.html#a51">Set2DProjection</a>(<a class="code" href="Oglmdi2_8cpp.html#a16">g_rectChild</a>.right, <a class="code" href="Oglmdi2_8cpp.html#a16">g_rectChild</a>.bottom);<font class="comment">// Set the childs projection matrix</font>
01604                             <font class="keywordflow">switch</font>(g_child[iLoop].<a class="code" href="structCHILD.html#m0">iType</a>)
01605                             {
01606                                 <font class="keywordflow">case</font> 2:
01607                                     <a class="code" href="Oglmdi2_8cpp.html#a53">Draw2DSceneFront</a>(g_child[iLoop].hWnd);
01608                                 <font class="keywordflow">break</font>;
01609 
01610                                 <font class="keywordflow">case</font> 3:
01611                                     <a class="code" href="Oglmdi2_8cpp.html#a54">Draw2DSceneTop</a>(g_child[iLoop].hWnd);
01612                                 <font class="keywordflow">break</font>;
01613 
01614                                 <font class="keywordflow">case</font> 4:
01615                                     <a class="code" href="Oglmdi2_8cpp.html#a55">Draw2DSceneLeft</a>(g_child[iLoop].hWnd);
01616                                 <font class="keywordflow">break</font>;
01617                             }
01618                         }
01619                     }
01620                     glFlush();
01621                     SwapBuffers(g_child[iLoop].hDC);
01622 
01623                     <font class="keywordflow">if</font> (<a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[49])
01624                     {
01625                         <font class="keywordflow">if</font> (<a class="code" href="Oglmdi2_8cpp.html#a19">Zoom</a> &lt; 1)
01626                             <a class="code" href="Oglmdi2_8cpp.html#a19">Zoom</a> += 0.001;
01627                     }
01628 
01629                     <font class="keywordflow">if</font> (<a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[50])
01630                     {
01631                         <font class="keywordflow">if</font> (<a class="code" href="Oglmdi2_8cpp.html#a19">Zoom</a> &gt; 0)
01632                             <a class="code" href="Oglmdi2_8cpp.html#a19">Zoom</a> -= 0.001;
01633                     }
01634 
01635                     <font class="keywordflow">if</font> (<a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[51])
01636                     {
01637                         <a class="code" href="Oglmdi2_8cpp.html#a22">VerticalShift</a> += 1;
01638                     }
01639 
01640                     <font class="keywordflow">if</font> (<a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[52])
01641                     {
01642                         <a class="code" href="Oglmdi2_8cpp.html#a22">VerticalShift</a> -= 1;
01643                     }
01644 
01645                     <font class="keywordflow">if</font> (<a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[53])
01646                     {
01647                         <a class="code" href="Oglmdi2_8cpp.html#a23">HorizontalShift</a> += 1;
01648                     }
01649 
01650                     <font class="keywordflow">if</font> (<a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[54])
01651                     {
01652                         <a class="code" href="Oglmdi2_8cpp.html#a23">HorizontalShift</a> -= 1;
01653                     }
01654 
01655                     <font class="keywordflow">if</font> (<a class="code" href="Oglmdi2_8cpp.html#a20">key</a>[VK_SPACE])
01656                     {
01657                         <a class="code" href="Oglmdi2_8cpp.html#a47">SetVertices</a>();
01658                         <a class="code" href="Oglmdi2_8cpp.html#a48">SetPolygons</a>();
01659                     }
01660 
01661                 }
01662             }
01663         }
01664     }
01665     <font class="keywordflow">return</font> Msg.wParam;
01666 }
01667 
01668 <font class="comment">/*</font>
01669 <font class="comment"></font>
01670 <font class="comment">If you use this code then give me credit and a link back to my site.</font>
01671 <font class="comment"></font>
01672 <font class="comment">btw</font>
01673 <font class="comment">The strange comment style you see in the code is a handy way to temporarily comment out blocks of</font>
01674 <font class="comment">code. By removing the first forward slash the code is disabled and to enable just add the first</font>
01675 <font class="comment">slash again. This saves having to run up and down the code adding and removing the first and last</font>
01676 <font class="comment">comment delimiters.</font>
01677 <font class="comment"></font>
01678 <font class="comment">ex.</font>
01679 <font class="comment"></font>
01680 <font class="comment">//*</font>
01681 <font class="comment">working code</font>
01682 <font class="comment">//*/</font>
01683 
01684 <font class="comment">/*</font>
01685 <font class="comment">disabled code</font>
01686 <font class="comment">//*/</font>
01687 
01688                                          
01689 
01690 
</pre></div><hr><address align="right"><small>Generated on Fri Dec 23 05:19:34 2005 for OpenGL MDI 2 by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
